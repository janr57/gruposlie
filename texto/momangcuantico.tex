% momangcuantico.tex
%
% Copyright (C) 2022--2025 José A. Navarro Ramón <janr.devel@gmail.com>
% Licencia del código GPLv2
% Licencia Creative Commons Recognition Non-Commercial Share-alike.
% (CC-BY-NC-SA)

\chapter{El momento angular en física cuántica}
\label{chapt:cua-momentoangular-cuantica}
En este capítulo estudiaremos el momento angular desde el punto de vista de la mecánica
cuántica. Recordamos brevemente las expresiones que obtuvimos en el capítulo anterior al
estudiar el momento angular desde el punto de vista de la mecánica clásica
\begin{align}
  \label{eq:cua-nL-clas}
  &\xhat{n}\cdot\vvv{L}
    = \vvv{r}^\trasp (\xhat{n}\cdot\mmm{G}) \vvv{p}\\
  \label{eq:cua-rotobj-clas}
  &\mmm{R}(\xhat{n},\theta)
    = \exp\left(\theta\,\xhat{n}\cdot\mmm{G}\right)\\
  \label{eq:cua-G1G2G3-clas}
  &\mmm{G}_1
    =
    \begin{pmatrix}
      0 & 0 & 0\\
      0 & 0 & 1\\
      0 & -1 & 0
    \end{pmatrix}
    ;\hspace{1em}
    \mmm{G}_2
    =
    \begin{pmatrix}
      0 & 0 & -1\\
      0 & 0 & 0\\
      1 & 0 & 0
    \end{pmatrix}
    ;\hspace{1em}
    \mmm{G}_3
    =
    \begin{pmatrix}
      0 & 1 & 0\\
      -1 & 0 & 0\\
      0 & 0 & 0
    \end{pmatrix}
\end{align}

La expresión~(\ref{eq:cua-nL-clas}) nos da el valor de la componente del momento angular
con respecto a un eje genérico $\xhat{n}$ y relaciona el momento angular con los
generadores del grupo de rotaciones SO(3).
La matriz de rotación pasiva alrededor de un eje $\xhat{n}$ cualquiera se especifica en
la ecuación~(\ref{eq:cua-rotobj-clas}).
Por último,~(\ref{eq:cua-G1G2G3-clas}) contiene una base de generadores para el grupo
SO(3).


\section{Rotación de vectores}
En esta sección veremos los generadores y la matriz de rotación de vectores en el
contexto de la mecánica cuántica, aunque también veremos que se pueden aplicar en
mecánica clásica.

\subsection{Generadores de rotación de vectores en mecánica cuántica}
En algún capítulo anterior señalamos que en mecánica cuántica las matrices u operadores
que representan a observables deben ser hermíticas o autoadjuntas, para que al medir
estos observables se obtengan valores reales.
Una matriz $\mmm{A}$ es hermítica cuando
\[
  \mmm{A}^\dagger = \mmm{A}
\]

El problema es que los generadores de la rotación~(\ref{eq:cua-G1G2G3-clas}), no son
matrices hermíticas
\[
  \mmm{G}_i^\dagger = -\mmm{G}_i
  \hspace{2em}
  (i=1,2,3)
\]

Por ejemplo
\[
  \mmm{G}_1^\dagger
  =
  \begin{pmatrix}
    0 & 0 & 0\\
    0 & 0 & 1\\
    0 & -1 & 0
  \end{pmatrix}^\dagger
  =
  \begin{pmatrix}
    0 & 0 & 0\\
    0 & 0 & -1\\
    0 & 1 & 0
  \end{pmatrix}
  =
  -\mmm{G}_1
\]

Vimos también que mediante un cambio, las $\mmm{G}$ se pueden poner en función de
matrices $\mmm{J}_i$ hermíticas
\[
  \mmm{G}_i = i\mmm{J}_i
  \hspace{1em}
  \text{o bien }
  \hspace{.5em}
  \mmm{J}_i = \frac{\mmm{G}_i}{i} = -i\mmm{G}_i
  \hspace{2em}
  (i=1,2,3)
\]

Las expresiones clásicas se convertirían en
\begin{align}
  \label{eq:cua-nL-v1}
  &\xhat{n}\cdot\vvv{L}
    = i\,\vvv{r}^\trasp (\xhat{n}\cdot \mmm{J}) \vvv{p}\\
  \label{eq:cua-rot-v1}
  &\mmm{R}(\xhat{n},\theta)
    = \exp\left(i\theta\,\xhat{n}\cdot\mmm{J}\right)\\
  \label{eq:cua-J1-J2-J3-v1}
  &\mmm{J}_1
    =
    \begin{pmatrix}
      0 & 0 & 0\\
      0 & 0 & -i\\
      0 & i & 0
    \end{pmatrix}
    ;\hspace{.5em}
    \mmm{J}_2
    =
    \begin{pmatrix}
      0 & 0 & i\\
      0 & 0 & 0\\
      -i & 0 & 0
    \end{pmatrix}
    ;\hspace{.5em}
    \mmm{J}_3
    =
    \begin{pmatrix}
      0 & -i & 0\\
      i & 0 & 0\\
      0 & 0 & 0
    \end{pmatrix}
\end{align}
Se deja como ejercicio comprobar que las $\mmm{J}_i$ son hermíticas.

Más adelante, cuando calculemos los conmutadores del momento angular en el contexto de la
mecánica cuántica, se modificarán ligeramente las expresiones anteriores, añadiendo la
constante de Planck reducida $\hbar$.
Esta modificación sólo se realizará en mecánica cuántica y no en matemáticas.

\subsection{Relaciones de conmutación}
Si calcularámos los conmutadores de los nuevos generadores obtendríamos
\begin{align*}
  [\mmm{J}_1, \mmm{J}_2] &= i\mmm{J}_3\\
  [\mmm{J}_2, \mmm{J}_3] &= i\mmm{J}_1\\
  [\mmm{J}_3, \mmm{J}_1] &= i\mmm{J}_2\\
  [\mmm{J}_1, \mmm{J}_2]
  &= [\mmm{J}_1, \mmm{J}_3]
    = [\mmm{J}_2, \mmm{J}_3] = 0\\
 [\mmm{J}_i, \mmm{J}_j] &= -[\mmm{J}_j, \mmm{J}_i]
\end{align*}

Todas estas relaciones de conmutación se pueden resumir en la expresión que se obtuvo
en~\eqref{eq:alg-j1-j2-Levi-Civita}, en función del símbolo de Levi-Civita
\begin{equation}\label{eq:cua-conmutacion-v1}
  [\mmm{J}_i,\mmm{J}_j] = i\, \epsilon_{ijk} \mmm{J}_k
\end{equation}

Con lo visto hasta ahora, podemos decir que el momento angular de toda la vida se
relaciona con estas $\mmm{J}_i$ de esta manera
\[
  \xhat{n}\cdot\vvv{L} = i\,\vvv{r}^\trasp \left(\xhat{n}\cdot\vvv{J}\right)\vvv{p}
\]


\subsection{Matriz de rotación con las  \mathinhead{\mmm{J}_i}{ji}}
Aunque estamos adaptando los generadores de rotación para la mecánica cuántica, estos
siguen siendo útiles en mecánica clásica. Para comprobarlo, vamos a obtener la matriz de
rotación alrededor del eje $z$ utilizando la expresión~(\ref{eq:cua-rot-v1}), mediante un
desarrollo de Taylor alrededor de $\theta = 0$ y teniendo en cuenta que el eje $z$ se
corresponde con el versor $\xhat{n} = (0,0,1)$
\begin{align*}
  \mmm{R}(\xhat{n},\theta)
  =
  e^{i\theta\,\xhat{n}\cdot\mmm{J}}
  =
  r^{i\theta\,(0,0,1)\cdot (\mmm{J}_1,\mmm{J}_2,\mmm{J}_3)}
  =
  e^{i\theta\,\mmm{J}_3}
\end{align*}

Necesitamos las potencias de $J_3$
\[
  J_3
  =
  \begin{pmatrix}
    0 & -i & 0\\
    i & 0 & 0\\
    0 & 0 & 0
  \end{pmatrix}
  ;\hspace{.5em}
  J_3^2
  = I_a =
  \begin{pmatrix}
    1 & 0 & 0\\
    0 & 1 & 0\\
    0 & 0 & 0
  \end{pmatrix}
  ;\hspace{.5em}
  J_3^3
  = J_3
  =
  \begin{pmatrix}
    0 & -i & 0\\
    i & 0 & 0\\
    0 & 0 & 0
  \end{pmatrix}; \cdots
\]

Cuando el exponente de $\mmm{J} _3$ es par, la matriz resultante la hemos denotamos por
$\mmm{I}_a$ y cuando es impar, el resultado es $\mmm{J}_3$. Además llamamos $\mmm{I}_b$ a
\[
  \mmm{I}_b
  =
  \begin{pmatrix}
    0 & 0 & 0\\
    0 & 0 & 0\\
    0 & 0 & 1
  \end{pmatrix}
\]

Observamos que se cumple
\[
  \mmm{I} = \mmm{I}_a + \mmm{I}_b
\]

A continuaución desarrollamos la exponencial por Taylor para un ángulo de giro $\theta$
de los ejes y en un entorno de $\theta=0$
\begin{align*}
  R_z(\theta)
  &=
    e^{i\theta\mmm{J}_3}
    =
    \mmm{I}
    +
    i\theta\mmm{J}_3
    +
    \frac{(i\theta\mmm{J}_3)^2}{2!}
    +
    \frac{(i\theta\mmm{J}_3)^3}{3!}
    +
    \frac{(i\theta\mmm{J}_3)^4}{4!}
    +
    \cdots\\
  &=
    \mmm{I}_a
    +
    \mmm{I}_b
    + i\theta\mmm{J}_3
    - \frac{1}{2!}\,\theta^2\mmm{I}_a
    - \frac{i}{3!}\,\theta^3\mmm{J}_3
    + \frac{1}{4!}\,\theta^4\mmm{I}_a
    + \cdots\\
  &=
    \mmm{I}_b
    + \left(
    1-\frac{1}{2!}\,\theta^2 +\frac{1}{4!}\,\theta^4 +\cdots
    \right) \mmm{I}_a
    + i\,\left(
    \theta -\frac{1}{3!}\,\theta^3 +\cdots
    \right) \mmm{J}_3\\
  &=
    \mmm{I}_b
    + \cos\theta\,\mmm{I}_a
    + i\sin\theta\,\mmm{J}_3\\
  &=
    \begin{pmatrix}
      0 & 0 & 0\\
      0 & 0 & 0\\
      0 & 0 & 1
    \end{pmatrix}
    +
    \begin{pmatrix}
      \cos\theta & 0 & 0\\
      0 & \cos\theta & 0\\
      0 & 0 & 0
    \end{pmatrix}
    + 
    \begin{pmatrix}
      0 & -i^2\sin\theta & 0\\
      i^2\sin\theta & 0 & 0\\
      0 & 0 & 0
    \end{pmatrix}
\end{align*}

El resultado es el mismo que el que se obtendría mediante los generadores
$\mmm{G}_i$ antisimétricos
\begin{equation}\label{eq:cua-Rz}
  \mmm{R}_z(\theta)
  =
  \begin{pmatrix}
    \cos\theta & \sin\theta & 0\\
    -\sin\theta & \cos\theta & 0\\
    0 & 0 & 1
  \end{pmatrix}
\end{equation}

\subsection{Ejemplo sencillo de rotación de vectores}
Supongamos, para simplificar, que nuestro espacio euclídeo es $\symbb{R}^3$, y tenemos que
rotar un punto (o una flechita) de coordenadas $(2,0,0)$, un ángulo de $\ang{90}$ o
$\pi/2~\unit{\radian}$ ---en sentido antihorario---, ver figura~\ref{fig:cua-funcrot1}.

Para girar un vector un ángulo $\pi/2~\unit{\radian}$, alrededor del eje $z$, deberíamos utilizar la
matriz de rotación activa
\[
  \mmm{R}
  = e^{-i\frac{\pi}{2}\,(\xhat{n}\cdot\vvv{J})}
  = e^{-i\frac{\pi}{2}\,(n_1J_1 + n_2J_2 + n_3J_3)}
  = e^{-i\frac{\pi}{2}\,(0\cdot J_1 + 0\cdot J_2 + 1\cdot J_3)}
  = e^{-i\frac{\pi}{2}J_3}
\]
\[
  \xtilde{P}
  =
  \begin{pmatrix}
    \tilde{x}\\
    \tilde{y}\\
    \tilde{z}
  \end{pmatrix}
  =
  \mmm{R}\vvv{r}
  =
  \begin{pmatrix}
    \cos\pi/2 & -\sin\pi/2 & 0\\
    \sin\pi/2 &  \cos\pi/2 & 0\\
    0 & 0 &1
  \end{pmatrix}
  \,
  \begin{pmatrix}
    2\\
    0\\
    0
  \end{pmatrix}
  =
  \begin{pmatrix}
    0 & -1 & 0\\
    1 &  0 & 0\\
    0 &  0 & 1
  \end{pmatrix}
  \,
  \begin{pmatrix}
    2\\
    0\\
    0
  \end{pmatrix}
  =
  \begin{pmatrix}
    0\\
    2\\
    0
  \end{pmatrix}  
\]
Así, el vector rotado es $\xtilde{P} = (0,2,0)$.

Esto sirve para rotar cualquier otro vector, como $\vvv{Q} = (3,3,0)$, produciendo el
vector $\xtilde{Q} = (-3,3,0)$, como se puede apreciar en el cálculo que sigue y se puede
ver en la figura~\ref{fig:cua-funcrot2}
\[
  \xtilde{Q}
  =
  \begin{pmatrix}
    \tilde{x}\\
    \tilde{y}\\
    \tilde{z}
  \end{pmatrix}
  =
  \mmm{R}\vvv{r}
  =
  \begin{pmatrix}
    0 & -1 & 0\\
    1 &  0 & 0\\
    0 &  0 & 1
  \end{pmatrix}
  \,
  \begin{pmatrix}
    3\\
    3\\
    0
  \end{pmatrix}
  =
  \begin{pmatrix}
    -3\\
    \phantom{-}3\\
    \phantom{-}0
  \end{pmatrix}  
\]

\begin{figure}[ht]
  \centering
  \begin{minipage}{0.40\linewidth}
    % Escala
    \def\scl{1}
    % Eje x
    \pgfmathsetmacro{\XMLONG}{0}
    \pgfmathsetmacro{\XPLONG}{3}
    % Eje y
    \pgfmathsetmacro{\YMLONG}{0}
    \pgfmathsetmacro{\YPLONG}{3}
    % Vector P
    \pgfmathsetmacro{\PMOD}{1.5}
    \pgfmathsetmacro{\PANG}{0}
    % Ángulo girado
    \pgfmathsetmacro{\ANG}{90}
    % Vector Ptilde
    \pgfmathsetmacro{\PtMOD}{\PMOD}
    \pgfmathsetmacro{\PtANG}{\PANG + \ANG}
    % Fondo
    \pgfmathsetmacro{\HORZ}{0.37}
    \pgfmathsetmacro{\VERT}{0.24}
    %
    \centering
    \begin{tikzpicture}[%
      scale=\scl,
      baseline,
      every node/.style={black,font=\small},
      eje/.style={->},
      vector/.style={-{Latex}, shorten >=1.0pt, line width=1.2pt, draw=\colorVorig},
      vectorrotado/.style={%
        -{Latex}, shorten >=1.0pt, line width=1.2pt, draw=\colorVrot},
      ptoorig/.style={fill=\colorPorig, draw=black},
      ptorot/.style={fill=\colorProt, draw=black},
      textoorig/.style={\colorTorig},
      textorot/.style={\colorTrot},
      dimmed/.style={lightgray, line width=.8pt, dotted},
      angulogirado/.style={fill=\colorAng, draw=\colorGirouno},
      background/.style={
        line width=\bgborderwidth,
        draw=\bgbordercolor,
        fill=\bgcolor,
      },
      ]
      % COORDENADAS
      \coordinate (O) at (0,0);
      \coordinate (xini) at (-\XMLONG cm,0);
      \coordinate (xfin) at (\XPLONG cm,0);
      \coordinate (yini) at (0,-\YMLONG cm);
      \coordinate (yfin) at (0,\YPLONG cm);
      \coordinate (P) at (\PANG:\PMOD cm);
      \coordinate (Pt) at (\PtANG:\PtMOD cm);      
      \path (O) -- coordinate (OPmidway) (P);
      % EJES
      \draw[eje] (xini) -- (xfin);
      \node[right, name=letraejey] at (xfin) {$x$};
      \draw[eje] (yini) -- (yfin);
      \node[above, name=letraejey] at (yfin) {$y$};
      % ÁNGULO DE GIRO
      \path (P) -- (O) -- (Pt) pic [%
      -{Latex[]},angulogirado,"\scriptsize $\ang{\ANG}$",
      angle radius=6.3mm, angle eccentricity=0.6] {angle = P--O--Pt};
      % VECTOR P
      % Vector de posición del punto P
      \draw[vector] (O) -- (P);
      \filldraw[ptoorig] (P) circle[radius=1.2pt];
      \node[above right=0pt and -3pt, \colorTorig] at (P)
      {\footnotesize $\vvv{P}\,(2,0,0)$};
      % VECTOR Pt
      % Vector de posición del punto P
      \draw[vectorrotado] (O) -- (Pt);
      \filldraw[fill=red, draw=black] (Pt) circle[radius=1.2pt];
      \node[above right=-3pt and 0pt, red!70!black] at (Pt)
      {\footnotesize $\xtilde{P}\,(0,2,0)$};
      % Origen
      \filldraw (O) circle [radius=.8pt];
      \node[below left=-1.5pt and -2.5pt] at (O) {\scriptsize $O$};
      
      % Fondo amarillo
      \coordinate (SW) at ($(current bounding box.south west) + (-\HORZ cm,-\VERT cm)$);
      \coordinate (NE) at ($(current bounding box.north east) + (\HORZ cm,\VERT cm)$);
      \begin{scope}[on background layer]
        \draw[background] (SW) rectangle (NE);
      \end{scope}
    \end{tikzpicture}
    \caption{Un vector $\vvv{P}$, en verde, y el vector rotado $\xtilde{P}$ rotado, en
      rojo.}
    \label{fig:cua-funcrot1}
  \end{minipage}
  \hspace{1em}
  \begin{minipage}{0.45\linewidth}
  % Escala
    \def\scl{1}
    % Eje x
    \pgfmathsetmacro{\XMLONG}{0}
    \pgfmathsetmacro{\XPLONG}{2.6}
    % Eje y
    \pgfmathsetmacro{\YMLONG}{0}
    \pgfmathsetmacro{\YPLONG}{3}
    % Vector Q
    \pgfmathsetmacro{\QMOD}{2.25}
    \pgfmathsetmacro{\QANG}{45}
    % Ángulo girado
    \pgfmathsetmacro{\ANG}{90}
    % Vector Qtilde
    \pgfmathsetmacro{\QtMOD}{\QMOD}
    \pgfmathsetmacro{\QtANG}{\QANG + \ANG}
    % Fondo
    \pgfmathsetmacro{\HORZ}{0.25}
    \pgfmathsetmacro{\VERT}{0.24}
    %
    \centering
    \begin{tikzpicture}[%
      scale=\scl,
      baseline,
      every node/.style={black,font=\small},
      eje/.style={->},
      vector/.style={-{Latex}, shorten >=1.0pt, line width=1.2pt, draw=\colorVorig},
      vectorrotado/.style={%
        -{Latex}, shorten >=1.0pt, line width=1.2pt, draw=\colorVrot},
      ptoorig/.style={fill=\colorPorig, draw=black},
      ptorot/.style={fill=\colorProt, draw=black},
      textoorig/.style={\colorTorig},
      textorot/.style={\colorTrot},
      dimmed/.style={lightgray, line width=.8pt, dotted},
      angulogirado/.style={fill=\colorAng, draw=\colorGirouno},
      background/.style={
        line width=\bgborderwidth,
        draw=\bgbordercolor,
        fill=\bgcolor,
      },
      ]
      % Coordenadas
      \coordinate (O) at (0,0);
      \coordinate (xini) at (-\XMLONG cm,0);
      \coordinate (xfin) at (\XPLONG cm,0);
      \coordinate (yini) at (0,-\YMLONG cm);
      \coordinate (yfin) at (0,\YPLONG cm);
      \coordinate (Q) at (\QANG:\QMOD cm);
      \coordinate (Qt) at (\QtANG:\QtMOD cm);
      \path (O) -- coordinate (OQmidway) (P);
      \coordinate (Q) at (\QANG:\QMOD cm);
      \path (O) -- coordinate (OQmidway) (P);
      % EJES
      \draw (-1.8,0) -- (xini);
      \draw[eje] (xini) -- (xfin);
      \node[right, name=letraejey] at (xfin) {$x$};
      \draw[eje] (yini) -- (yfin);
      \node[above, name=letraejey] at (yfin) {$y$};
      % ÁNGULO DE GIRO
      \path (Q) -- (O) -- (Qt) pic [%
      -{Latex[]},angulogirado,"\scriptsize $\ang{\ANG}$",angle radius=6.3mm,
      angle eccentricity=0.60]
      {angle = Q--O--Qt};
      %\node at (0,0.35) {\footnotesize \ang{\ANG}};
      % VECTOR Q
      % Vector de posición del punto Q
      \draw[vector] (O) -- (Q);
      \filldraw[ptoorig] (Q) circle[radius=1.2pt];
      \node[above right=0pt and -7pt, textoorig] at (Q) {\scriptsize $\vvv{Q}\,(3,3,0)$};
      % VECTOR Qt
      % Vector de posición del punto Qpp
      \draw[vectorrotado] (O) -- (Qt);
      \filldraw[ptorot] (Qt) circle[radius=1.2pt];
      \node[above right=0pt and -7pt, textorot] at (Qt)
      {\scriptsize $\xtilde{Q}\,(-3,3,0)$};
      % Origen
      \filldraw (O) circle [radius=.8pt];
      \node[below=-1pt] at (O) {\scriptsize $O$};
      
      % Fondo amarillo
      \coordinate (SW) at ($(current bounding box.south west) + (-\HORZ cm,-\VERT cm)$);
      \coordinate (NE) at ($(current bounding box.north east) + (\HORZ cm,\VERT cm)$);    
      \begin{scope}[on background layer]
        \draw[background] (SW) rectangle (NE);
      \end{scope}
    \end{tikzpicture}
    \caption{Otro vector $\vvv{Q}$, en verde, y el vector rotado $\tilde{Q}$, en rojo.}
    \label{fig:cua-funcrot2}
  \end{minipage}
\end{figure}


\section{Rotación de funciones en el espacio\/
  \mathinhead{L^2\!\left(\symbb{R}^3\right)}{RdfeleL2R3}}
\label{sect:cua-rotacion-funciones}
En la sección~\ref{sect:cla-invariancia-bajo-rotaciones} se explicó cómo comprobar si una
función es invariante frente a rotaciones en el espacio euclídeo.
En esta vamos a extenderla al espacio de funciones $L^2\!\left(\symbb{R}^3\right)$, esto
es, funciones complejas de variable real en el espacio euclídeo.
La principal diferencia con respecto a la sección anterior está en que aquí necesitamos
utilizar matrices hermíticas, de manera que recurriremos a los generadores $\mmm{J}$.

Aquí trataremos con funciones definidas en $\symbb{R}^3$ que hacen corresponder a cada
punto del espacio $x, y, z$ un valor complejo.

Es importante recordar que, en una rotación pasiva, podemos considerar que rotan los ejes
pero no estamos rotando la función. Pero también podemos interpretar que ha girado la
función en sentido contrario, mientras que los ejes no rotan.

Si queremos rotar la función en sentido antihorario, tendremos que
actuar como si giráramos los ejes en sentido horario mediante la matriz inversa de
\ref{eq:cua-rot-v1}.
Pero, dado que es la rotación que nos interesa, prescindiremos del exponente $-1$ y la
representaremos como $\mmm{R}$
\[
  \mmm{R}(\xhat{n},\theta)
  = e^{-i\theta\,\xhat{n}\cdot\mmm{J}}
\]
donde el signo negativo indica que la rotación activa de los objetos se lleva a cabo
girando los ejes en sentido horario (negativo).

\subsection{Ejemplo sencillo}
Hemos visto el generador de rotación de vectores, pero ahora nos interesamos por el de
funciones.
Usaremos el símbolo $\Psi$ para representar cualquier función genérica definida en el
espacio euclídeo. Este símbolo lo utilizamos para que parezca una función de onda en mecánica cuántica aunque, por ahora, podrá ser cualquier función, real o compleja, de las
coordenadas pero, más tarde, representará funciones compleja de variable real.

Pretendemos deducir cómo rotar una función utilizando un ejemplo sencillo.
Así, nos proponemos rotar una función definida en $\symbb{R}^2$, un ángulo de \ang{90}
($\pi/2\,\unit{\radian}$). El valor de la función lo representaremos en el eje $z$
\[
  z = \Psi(x,y) = 2x + 3y
\]

Es importante dejar claro desde el principio que nos interesa obtener la expresión de la
función rotada $\tilde{\Psi}\!\left(\tilde{x},\tilde{y}\right)$.

La matriz de rotación activa alrededor del eje $z$ es
\begin{align*}
  \mmm{R}((0,0,1), \pi/2)
  &=
    e^{-i\frac{\pi}{2} (\xhat{n}\cdot\mmm{J})}
    =
    e^{-i\frac{\pi}{2} (0 J_1 + 0 J_2 + 1 J_3)}
    =
    e^{-i\frac{\pi}{2} J_3}\\
  &=
    \begin{pmatrix}
      \cos\pi/2 & -\sin\pi/2 & 0\\
      \sin\pi/2 & \phantom{-}\cos\pi/2 & 0\\
      0 & 0 & 1
    \end{pmatrix}
    =
  \begin{pmatrix}
    0 & -1 & 0\\
    1 & \phantom{-}0 & 0\\
    0 & \phantom{-}0 & 1
  \end{pmatrix}      
\end{align*}

Las nuevas coordenadas $\xtilde{r}$ de cualquier punto $\vvv{r} = (x, y, z)$ de la
función, se calculan haciendo actuar la matriz de rotación anterior sobre este
\[
  \xtilde{r}
  =
  \mmm{R} \vvv{r}
\]
\[
  \begin{pmatrix}
    \tilde{x}\\
    \tilde{y}\\
    \tilde{z}
  \end{pmatrix}
  =
  \begin{pmatrix}
    0 & -1 & 0\\
    1 & \phantom{-}0 & 0\\
    0 & \phantom{-}0 & 1
  \end{pmatrix}
  \,
  \begin{pmatrix}
    x\\
    y\\
    z
  \end{pmatrix}
  =
  \begin{pmatrix}
    -y\\
    \phantom{-}x\\
    \phantom{-}z
  \end{pmatrix}
\]
y obtenemos las coordenadas de la función rotada
\vspace*{-1ex}
\begin{subequations}
  \begin{align}\label{eq:cua-ejsenc-xtilde}
    \tilde{x} &= -y\\
    \label{eq:cua-ejsenc-ytilde}
    \tilde{y} &= x\\
    \label{eq:cua-ejsenc-ztilde}
    \tilde{z} &= z
  \end{align}
\end{subequations}

Como se aprecia en las igualdades anteriores, las nuevas coordenadas
$\left(\tilde{x},\tilde{y}\right)$ asociadas cualquier punto original $(x,y)$ del dominio
de la función se presentan en las igualdades \ref{eq:cua-ejsenc-xtilde} y
\ref{eq:cua-ejsenc-ytilde}, y la última \ref{eq:cua-ejsenc-ztilde}, se refiere al valor
de la función rotada $\tilde{\Psi}\!\left(\tilde{x},\tilde{y}\right)$.

Obsérvese que, en general ---a menos que se trate de la rotación identidad---, las
coordenadas del dominio $(x,y)$ cambian, pero el valor de la función al rotar nunca lo
hace
\begin{subequations}
  \begin{align*}
    x
    &\longrightarrow
      \tilde{x}\neq x\\
    y
    &\longrightarrow
      \tilde{y}\neq y\\
    z = \Psi(x,y)
    &\longrightarrow
      \tilde{z} = \tilde{\Psi}\!\left(\tilde{x},\tilde{y}\right)=\Psi(x,y) 
  \end{align*}
\end{subequations}
Esto es, cada punto del dominio $(x,y)$ rota a una nueva posición
$\left(\tilde{x},\tilde{y}\right)$, pero arrastra consigo el valor que tenía la función
original en $(x,y)$.

La igualdad
\[
  \tilde{\Psi}\!\left(\tilde{x},\tilde{y}\right)
  =
  \Psi(x,y)
\]
equivale, en nuestro caso a
\begin{equation}\label{eq:cua-ejsenc-funcion}
  \tilde{\Psi}\!\left(\tilde{x},\tilde{y}\right)
  =
  2x + 3y
\end{equation}
La ecuación anterior nos da una pista para calcular la función rotada, pero tiene un
problema. El valor de la función rotada (primer miembro de la igualdad) está en función
del valor que \emph{tenía en función de las coordenadas antes de rotar $x$ e $y$}
(segundo miembro de la igualdad). Para solucionar esto, tenemos que expresar las
coordenadas $x$ e $y$, en función de las nuevas $\tilde{x}$ y $\tilde{y}$, con el fin de
que la función rotada $\tilde{\Psi}$ se encuentre correctamente expresada.

Esto es, debemos hallar las coordenadas originales $x$ e $y$ en función de las rotadas
$\tilde{x}$ y $\tilde{y}$. Esto supone aplicar a las $\xtilde{r}$, la matriz inversa
$\mmm{R}^{-1}$ de la que habíamos utilizado para rotar la función,
$\\xtilde{r} = \mmm{R}\vvv{r}$
\[
  \vvv{r} = \mmm{R}^{-1}\xtilde{r}
\]

Puesto que $\mmm{R}$ es una  matriz ortogonal, basta con calcular su
transpuesta\footnotemark{}
\footnotetext{Si estuviéramos en el espacio de funciones $L^2\left(\symbb{R}^3\right)$,
  habría que calcular la inversa mediante la transpuesta, compleja conjugada
  $U^\dagger$.}
\[
  \mmm{R}^{-1}
  =
  \begin{pmatrix}
    0 & -1 & 0\\
    1 & \phantom{-}0 & 0\\
    0 & \phantom{-}0 & 1
  \end{pmatrix}^{-1}
  =
  \begin{pmatrix}
    0 & -1 & 0\\
    1 & \phantom{-}0 & 0\\
    0 & \phantom{-}0 & 1
  \end{pmatrix}^\transp
  =
  \begin{pmatrix}
    \phantom{-}0 & 1 & 0\\
    -1 & 0 & 0\\
    \phantom{-}0 & 0 & 1
  \end{pmatrix}
\]

Hacemos actuar la inversa de la matriz sobre las nuevas coordenadas, obtenemos lo que
pretendíamos
\[
  \begin{pmatrix}
    x\\
    y\\
    z
  \end{pmatrix}
  =
  \begin{pmatrix}
    \phantom{-}0 & 1 & 0\\
    -1 & 0 & 0\\
    \phantom{-}0 & 0 & 1
  \end{pmatrix}
  \,
  \begin{pmatrix}
    \tilde{x}\\
    \tilde{y}\\
    \tilde{z}
  \end{pmatrix}
  =  
  \begin{pmatrix}
    \phantom{-}\tilde{y}\\
    -\tilde{x}\\
    \phantom{-}\tilde{z}
  \end{pmatrix}
\]
Resumiendo
\vspace*{-1ex}
\begin{subequations}
  \begin{align}\label{eq:cua-ejsenc-x}
    x &= \phantom{-}\tilde{y}\\
    \label{eq:cua-ejsenc-y}
    y &= -\tilde{x}\\
    \label{eq:cua-ejsenc-z}
    z &= \phantom{-}\tilde{z}
  \end{align}
\end{subequations}

Sustituimos en \eqref{eq:cua-ejsenc-funcion}
\[
  \tilde{\Psi}\!\left(\tilde{x},\tilde{y}\right)
  =
  2x + 3y
  =
  2 \tilde{y} + 3 (-\tilde{x})
  =
  -3\tilde{x} + 2\tilde{y}
\]
Ahora que tenemos la función rotada, las coordenadas con tilde son prescindibles
\begin{equation}\label{eq:cua-ejsenc-funcionrotada}
  \tilde{\Psi}(x,y)
  =
  -3x + 2y
\end{equation}

\subsubsection{Comprobación}
Vamos a comprobar que la función rotada es correcta, fijándonos en un punto concreto de los infinitos de que consta el dominio de la función original
\eqref{eq:cua-ejsenc-funcion}.
Elegimos por ejemplo el punto $P(0,1)$, representado por el vector $\vvv{P} = (1,0)$. a función original da el resultado
\begin{equation}
  \Psi(\vvv{P}) = \Psi(1,0) = 2\cdot 1 + 3\cdot 0 = 2 + 0 = 2
\end{equation}

Rotamos el vector $\vvv{P} = (1,0)$ utilizando las igualdades
\eqref{eq:cua-ejsenc-xtilde} y \eqref{eq:cua-ejsenc-ytilde}
\[
  \vvv{P} = (1,0)
  \longrightarrow
  \xtilde{P} = (0,1)
\]
La función rotada tiene el valor
\[
  \tilde{\Psi}(\xtilde{P})
  =
  \tilde{\Psi}(0,1)
  =
  -3\cdot 0 +  2\cdot 1
  = 0 + 2
  = 2
\]

\begin{figure}[ht]
  \def\scl{1}
  %
  \tdplotsetmaincoords{60}{110}
  %
  % Longitud de los ejes x e y
  \pgfmathsetmacro{\LONGXY}{3.0}
  % Longitud del eje z
  \pgfmathsetmacro{\LONGZ}{3.8}
  % Longitud de los puntos P y Ptilde en sus ejes
  \pgfmathsetmacro{\PVEC}{1.7}
  \pgfmathsetmacro{\PtVEC}{\PVEC}
  % Posición del punto z en su eje
  \pgfmathsetmacro{\Z}{2.3}
  \pgfmathsetmacro{\thetavec}{90}
  \pgfmathsetmacro{\phivec}{90}
  % Fondo
  \pgfmathsetmacro{\HORZ}{0.25}
  \pgfmathsetmacro{\VERT}{0.25}
  % 
  \tikzfading[%
  name=fade out, inner color=transparent!0, outer color=transparent!100
  ]
  
  \centering
  \begin{tikzpicture}[%
    scale=\scl,tdplot_main_coords,
    every node/.append style={font=\footnotesize},
    axisrotation/.style={%
      line width=1.6pt,-{Latex[round,length=12pt,width=7.0pt,bend]}, color=black!30},
    angulogiro/.style={%
      line width=1.4pt,-{Latex[round,length=7pt,width=4.5pt,bend]},black!30},
    eje/.style={line width=0.5pt, ->},
    vectorR/.style={-{Latex[width=6pt,length=6pt]},\colorVorig,line width=1.2pt},
    vectorRt/.style={-{Latex[width=6pt,length=6pt]},\colorVrot,line width=1.2pt},
    puntoP/.style={fill=black,draw=black,radius=0.8pt},
    puntoPt/.style={fill=black,draw=black,radius=0.8pt},
    puntoR/.style={fill=\colorPorig,draw=black,radius=1.4pt},
    puntoRt/.style={fill=\colorProt,draw=black,radius=1.4pt},
    textoP/.style={color=\colorTorig},
    textoPt/.style={color=\colorTrot},
    textoR/.style={textoP},
    textoRt/.style={textoPt},
    lineaguia/.style={black!50, line width=0.8pt, densely dotted},
    background/.style={%
      line width=\bgborderwidth,
      draw=\bgbordercolor,
      fill=\bgcolor,
    },
    ]
    % COORDENADAS
    \path[save path=\pathP] (0,0,0) -- (\PVEC,0,0) coordinate (P);
    \path[save path=\pathPt](0,0,0) -- (0,\PtVEC,0) coordinate (Pt);
    \path (P) -- ++(0,0,\Z) coordinate (R);
    \path (Pt) -- ++(0,0,\Z) coordinate (Rt);
    \path[save path=\pathR] (0,0,0) -- coordinate (Rmedio) (R);
    \path[save path=\pathRt] (0,0,0) -- coordinate (Rtmedio) (Rt);    
    \path (Rt) -- ++(0,-\PtVEC,0) coordinate (z);
    
    % EJES
    % Para 'tikz-3dplot' son los ejes principales
    \draw[eje] (0,0,0) -- (\LONGXY,0,0) coordinate (ejex);
    \node[below left,name=letraejex] at (ejex) {$x$};
    \draw[eje] (0,0,0) -- (0,\LONGXY,0) coordinate (ejey);
    \node[below right,name=letraejey] at (ejey) {$y$};
    \draw[eje] (0,0,0) -- (0,0,\LONGZ) coordinate (ejez);
    \node[above,name=letraejez] at (ejez){$z$};

    % LÍNEAS GUÍA
    \draw[lineaguia] (P) -- (R);
    \draw[lineaguia] (Pt) -- (Rt);
    \draw[lineaguia] (R) -- (z);
    \draw[lineaguia] (Rt) -- (z);

    % PUNTO DOMINIO P
    \filldraw[puntoP] (P) circle;
    \node[left=2pt, textoP] at (P) {$\vvv{P}\,(1,0)$};
    % PUNTO DOMINIO Ptilde
    \filldraw[puntoPt] (Pt) circle;
    \node[above right=-2pt and -1pt, textoPt] at (Pt) {$\xtilde{P}\,(0,1)$};
    
    % REPRESENTACIÓN DEL GIRO ALREDEDOR DEL EJE Z
    % \tdplotsetthetaplanecoords{-90}
    % Notice you have to tell tiks-3dplot you are now in rotated coords
    % Since tikz-3dplot swaps the planes in tdplotsetthetaplanecoords,
    % the former y axis is now the z axis.
    \tdplotdrawarc[axisrotation] {(0,0,3.0)}{0.35}{70}{410}{};
    % REPONER PARTE FINAL DEL EJE z PARA SIMULAR PERSPECTIVA
    \draw[eje] (0,0,2.9) -- (0,0,\LONGZ);
    
    % VECTOR DE POSICIÓN r
    \draw[vectorR, use path=\pathR];
    \filldraw[puntoR] (R) circle;
    \node[below left=1pt and -2pt, textoR] at (Rmedio) {$\vvv{r}$};
    \node[left=2pt, textoR] at (R) {$(1,0,2)$};
    
    % VECTOR DE POSICIÓN rtilde
    \draw[vectorRt, use path=\pathRt];
    \filldraw[puntoRt] (Rt) circle;
    \node[below right=-1pt and -1pt, textoRt] at (Rtmedio)
    {\footnotesize $\xtilde{r}$};
    \node[right=1pt, textoRt] at (Rt) {$(0,1,2)$};    

    % VALOR DE LA FUNCIÓN PARA P(1,0)
    \filldraw[puntoP] (z) circle;
    
    % ÁNGULO PHI 
    \tdplotsetthetaplanecoords{\thetavec}
    % Dibuja el ángulo \phi y etiquétalo
    % sintaxis:
    % \tdplotdrawarc[coordinate frame, draw options]
    % {center point}{r}{angle}{label options}{label}
    \tdplotdrawarc[angulogiro]
    {(0,0,0)}{1.6}{8}{\phivec-12}{anchor=north}
    {\textcolor{black!60}{$\pi/2\,\unit{\radian}$}};

    % Fondo amarillo
    \coordinate (SW) at ($(current bounding box.south west) + (-\HORZ cm,-\VERT cm)$);
    \coordinate (NE) at ($(current bounding box.north east) + (\HORZ cm,\VERT cm)$);    
    \begin{scope}[on background layer]
      \draw[background] (SW) rectangle (NE);
    \end{scope}
  \end{tikzpicture}
  \caption{Rotación de \ang{90} de un punto $\vvv{r}$, en gris, de la función
    original $\Psi(x,y,z) = 2x + 3y$, alrededor del eje $z$, hasta el punto
    $\xtilde{r}$, en rojo, de la función rotada $\tilde{\Psi}=-3x+2y$.}
  \label{fig:cua-rot-ejsenc-funcion}
\end{figure}

\subsubsection{Conclusión}
La función rotada se calcula a partir de la original aplicando sobre el argumento la
inversa de la rotación
\begin{equation}\label{eq:cua-funcionrotadadef}
  \tilde{\Psi}(\vvv{r})
  =
  \Psi(\mmm{R}^{-1}\vvv{r})
\end{equation}
Es importante darse cuenta que $\mmm{R}^{-1}\vvv{r}$ se encuentra en el argumento de la
función y solo afecta a las coordenadas $x$ e $y$ de $\symbb{R}^2$, por lo que esta
transformación se podría haber realizado mediante una rotación pasiva en SO(2).


\subsection{Generador de rotación para funciones}
\label{ssect:cua-generador-rotacion-funciones}
\begin{equation}\label{eq:cua-funcionrotadadef}
  \tilde{\Psi}(\xtilde{r})
  =
  \Psi(\mmm{R}^{-1}\vvv{r})
\end{equation}

Queremos rotar una función, no los ejes, la matriz de rotación activa es
\[
  \mmm{R}(\theta)=e^{-i\theta\,\xhat{n}\cdot\mmm{J}}
\]
y como las rotaciones forman un grupo de Lie, podemos aplicar rotaciones infinitesimales
y las conclusiones a las que lleguemos serán válidas para cualquier rotación finita
\[
  \mmm{R}(\varepsilon)
  =
  e^{-i\varepsilon \xhat{n}\cdot\mmm{J}}
  =
  \mmm{I} - i\varepsilon \xhat{n}\cdot\mmm{J}
\]

Como $\mmm{J}$ es hermítica, la rotación inversa será la adjunta\footnotemark{}
o transpuesta conjugada
\footnotetext{Aquí, \emph{adjunta} es la \emph{adjunta hermitiana} o transpuesta compleja
  conjugada, usada en espacios complejos y unitarios, por ejemplo
  $\mmm{U}^\dagger \mmm{U} = I$. En este contexto, no es la matriz adjunta clásica
  $\text{adj}(\mmm{A})$ que es la matriz de cofactores transpuesta, usada para encontrar
  la inversa de matrices reales o complejas
  ($\mmm{A}^{-1} = \frac{1}{\text{det}(A)}\,\text{adj}(A)$)}.
\[
  \mmm{J}^\dagger = \mmm{J}
\]
Así
\begin{align*}
  \mmm{R}^{-1}(\varepsilon)
  &=
    \mmm{R}^\dagger(\varepsilon)
    =
    (\mmm{I} - i\varepsilon\xhat{n}\cdot\mmm{J})^\dagger
    =
    I^\dagger- i^*\varepsilon(\xhat{n}\cdot\mmm{J})^\dagger
    =
    I + i\varepsilon(\xhat{n}\cdot\mmm{J})
\end{align*}

Entonces
\[
  \mmm{R}^{-1} \vvv{r}
  =
  (I + i\varepsilon\xhat{n}\cdot\mmm{J}) \vvv{r}
  =
  \vvv{r} + i\varepsilon(\xhat{n}\cdot\mmm{J})\vvv{r}
\]

Ahora, se desarrolla la función rotada~(\ref{eq:cua-funcionrotadadef}) en serie de
potencias\footnotemark{}
\footnotetext{$f(x+a) \approx f(x) + \dfrac{\partial f}{\partial x} a;
  \text{ para } a \ll x$.}
\begin{align*}%\label{eq:cua-desarrollo-psi}
  \tilde{\Psi}(\vvv{r})
  &=
    \Psi(\mmm{R}^{-1}\vvv{r})
    =
    \Psi\!\left(\vvv{r} + i\varepsilon(\xhat{n}\cdot\mmm{J})\vvv{r}\right)
    =
    \Psi\!\left(\vvv{r}\right)
    + \left(\frac{\partial\Psi(\vvv{r})}{\partial\vvv{r}}\right)^\trasp
    i\varepsilon\left(\xhat{n}\cdot\mmm{J}\right)\vvv{r}\\
\end{align*}
Simplificamos un poco la notación y pasamos $\varepsilon$ hacia la izquierda y la unidad
imaginaria $i$ hacia $\mmm{J}$
\begin{equation}
  \tilde{\Psi}\label{eq:cua-psirotada-intermedia-J}
  =
  \Psi
  + \varepsilon
  \left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
  \left(\xhat{n}\cdot i\mmm{J}\right)\vvv{r}
\end{equation}
Pero $\mmm{G}=i\mmm{J}$, ver \eqref{eq:alg-rot-activa}
\begin{equation}
  \tilde{\Psi}\label{eq:cua-psirotada-intermedia-G}
  =
  \Psi
  + \varepsilon
  \left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
  \left(\xhat{n}\cdot\mmm{G}\right)\vvv{r}
\end{equation}
Necesitamos que en el segundo sumando, la derivada de la función se encuentre a la
derecha. Esto se puede conseguir realizando la transpuesta de ese sumando.
La transpuesta es posible, pues ese término es un escalar (no es un vector ni matriz).

Vayamos por partes, fijémonos en los siguientes detalles:
\begin{itemize}
\item La derivada parcial de $\Psi$ con respecto de $\vvv{r}$ es una matriz transpuesta,
  es decir, es un vector fila $1\times 3$, y es el gradiente de $\Psi$.
  Esta es una función compleja de variable real.
  \[
    \left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
    =
    \begin{pmatrix}
      \dfrac{\partial\Psi}{\partial x}
      & \dfrac{\partial\Psi}{\partial y}
      & \dfrac{\partial\Psi}{\partial z}
    \end{pmatrix}
    =
    \begin{pmatrix}
      \partial_x\Psi & \partial_y\Psi & \partial_z\Psi
    \end{pmatrix}
    = \left(\vvv{\nabla}\Psi\right)^\trasp
  \]
\item El \emph{producto} $\xhat{n}\cdot\mmm{G}$ es una matriz cuadrada $3\times 3$,
  antisimétrica: $(\xhat{n}\cdot\mmm{G})^\trasp = -(\xhat{n}\cdot\mmm{G})$.
  En cambio, $(\xhat{n}\cdot\mmm{J})$ es hermítica
  \[
    (\xhat{n}\cdot\mmm{J})^\dagger = \xhat{n}\cdot\mmm{J}
  \]
  
  Todos sus elementos son reales.
\item El vector $\vvv{r}$ es un vector columna $3\times 1$. Sus elementos son reales
  \[
    \vvv{r}
    =
    \begin{pmatrix}
      x\\
      y\\
      z
    \end{pmatrix}
  \]
\item El ángulo infinitesimal $\varepsilon$ es un escalar real. Sus dimensiones son
  $1\times 1$.
\item El segundo sumando tiene dimensiones $1\times 1$, por tanto es un escalar
    \[
    \text{dimensiones }
    \longrightarrow
    (1\times 1)\,(1\times 3)\,(3\times 3)\,(3\times 1) = 1\times 1
  \]
  Por tanto, también lo es la expresión \eqref{eq:cua-psirotada-intermedia-J}
  \[
    i\varepsilon\left(\frac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
    (\xhat{n}\cdot\mmm{J})\vvv{r}
    \longrightarrow
    \text{escalar}
  \]
  Como es un escalar, su transpuesta es el mismo escalar
  \begin{align*}
    i\varepsilon
    \left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
    \left(\xhat{n}\cdot\mmm{J}\right) \vvv{r}
    &=
      \left[%
      i\varepsilon
      \left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
      \left(\xhat{n}\cdot\mmm{J}\right) \vvv{r}
      \right]^\trasp
%      =
%      i\varepsilon
%      \vvv{r}^\trasp
%      \left(\xhat{n}\cdot\mmm{J}\right)^\trasp
%      \dfrac{\partial\Psi}{\partial\vvv{r}}\\
%    &=
%      i\varepsilon
%      \vvv{r}^\trasp
%      \left(\xhat{n}\cdot\mmm{J}\right)
%      \dfrac{\partial\Psi}{\partial\vvv{r}}
  \end{align*}
\end{itemize}


Seguimos con el desarrollo de la función rotada infinitesimalmente \eqref{eq:cua-psirotada-intermedia-J}
\begin{align*}%\label{eq:cua-desarrollo-psi}
  \tilde{\Psi}
  &=
    \Psi
    + i\varepsilon\left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
    \left(\xhat{n}\cdot\mmm{J}\right)\vvv{r}
    =
    \Psi
    + \left[%
    i\varepsilon\left(\frac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp
    \left(\xhat{n}\cdot\mmm{J}\right)\vvv{r}\right]^\trasp\\
  &=
    \Psi
    + i\varepsilon\vvv{r}^\trasp \left(\xhat{n}\cdot\mmm{J}\right)^\trasp
   \left[\left(\dfrac{\partial\Psi}{\partial\vvv{r}}\right)^\trasp\right]^\trasp
    =
    \Psi
    - i\varepsilon\vvv{r}^\trasp\left(\xhat{n}\cdot\mmm{J}\right)
    \dfrac{\partial\Psi}{\partial\vvv{r}}\\
  &=
    \left(
    1 - i\varepsilon\vvv{r}^\trasp \left(\xhat{n}\cdot\mmm{J}\right)
    \dfrac{\partial}{\partial\vvv{r}}
    \right)
    \Psi\\
  &=
    \left(
    1 - i\varepsilon\vvv{r}^\trasp \left(\xhat{n}\cdot\mmm{J}\right)
    \vvv{\nabla}
    \right)    
\end{align*}
donde el gradiente es $\partial/\partial\vvv{r}
= \vvv{\nabla} = (\partial_x,\partial_y,\partial_z)
=(\partial/\partial x,\partial/\partial y, \partial/\partial z)$

Para una rotación finita
\[
  \tilde{\Psi}(\xtilde{r})
  = \exp\left\{-i\theta\vvv{r}^\dagger (\xhat{n}\cdot\mmm{J})\vvv{\nabla}\right\}
  \,\Psi(\vvv{r})
\]

Ahora bien, sabemos que en mecánica cuántica el momento se define como
\[
  \vvv{p} \equiv -i\hbar\vvv{\nabla}
  \hspace{0.5em}
  \longrightarrow
  \hspace{0.5em}
  \vvv{\nabla}
  = \dfrac{\vvv{p}}{-i\hbar}
  = \dfrac{i\vvv{p}}{\hbar}
\]
\begin{align*}
  \tilde{\Psi}(\xtilde{r})
  &=
  \exp\left\{
    -i\theta\vvv{r}^\trasp (\xhat{n}\cdot\mmm{J})\,\frac{i\vvv{p}}{\hbar}
  \right\}
  \,\Psi(\vvv{r})
  =
  \exp\left\{
    -i\frac{\theta}{\hbar}\vvv{r}^\trasp (\xhat{n}\cdot i\mmm{J})\,\vvv{p}
  \right\}
    \,\Psi(\vvv{r})\\
  &=
  \exp\left\{
    -i\frac{\theta}{\hbar}\vvv{r}^\trasp (\xhat{n}\cdot i\mmm{J})\vvv{p}
  \right\}
    \,\Psi(\vvv{r})  
  \end{align*}
Y teniendo en cuenta la expresión~\ref{eq:cua-nL-v1}, que relaciona el momento angular
con los generadores $\mmm{J}$, la función rotada un ángulo discreto $\theta$ es
\[
  \tilde{\Psi}(\xtilde{r})
  =
  \exp\left\{-i\frac{\theta}{\hbar}\xhat{n}\cdot\vvv{L}\right\}\,\Psi(\vvv{r})
\]

El operador de rotación en SO(3) para funciones es
\begin{equation}
  \label{eq:cua-rot-nL}
  \mmm{R}(\xhat{n},\theta)
  =
  \exp\left\{-i\frac{\theta}{\hbar}\, \xhat{n}\cdot\vvv{L}\right\}
\end{equation}

Este operador sirve para rotar funciones, reales o complejas, definidas en el espacio
euclídeo $\symbb{R}^3$, alrededor de un cierto eje $\xhat{n}$.
Otra conclusión a la que se llega es que se conecta directamente el momento angular con
una rotación.

\section{Conmutadores básicos}
Se pretende calcular algunos conmutadores básicos en mecánica cuántica, sobre todo, los
relacionados con el momento angular y compararlos con los de los generadores de rotación
$\mmm{J}$.
\begin{itemize}
\item Empezamos con una propiedad importante de los conmutadores
  \[
    [A,B]
    = AB - BA
    = -(BA - AB)
    = -[B,A]
  \]
  La propiedad es
  \begin{equation}\label{eq:cua-conmut-inversa}
    [A,B] = -[B,A]
  \end{equation}

\item Empezaremos con los conmutadores de las coordenadas. Nos fijaremos en $[x,y]$.
  Observamos que las dos coordenadas se pueden intercambiar libremente en toda expresión;
  esto significa que son independientes y que el conmutador dará cero
  \[
    [x,y]
    = xy - yx
    = xy - xy
    = 0
  \]
  Lo mismo ocurre con cualquier combinación de ellas, incluso aún cuando se trate de la
  misma coordenada.

  Resumimos esta observación
  \begin{equation}\label{eq:cua-conmut-posiciones}
    [r_i,r_j] = 0
  \end{equation}

\item Lo mismo ocurre con los conmutadores de las derivadas parciales. Se pueden
  intercambiar libremente siempre que las funciones se comporten bien
  \begin{equation}\label{eq:cua-conmut-derivadas}
    \left[\frac{\partial}{\partial r_i},\frac{\partial}{\partial r_j}\right]
    =
    0
  \end{equation}

\item Ahora nos ocupamos de los que contienen coordenadas y derivadas.
  Si queremos hallar, por ejemplo, el conmutador $[x,\partial/\partial x]$, nos damos
  cuenta de que no se pueden intercambiar libremente, de manera que para calcularlo, le
  aplicamos una función y observamos el resultado
\[
  \left[x,\frac{\partial}{\partial x}\right] f
  =
  x\frac{\partial f}{\partial x} - \frac{\partial }{\partial x} xf
  =
  xf' - (f + xf')
  =
  -f
\]

Por tanto, $[x,\partial/\partial x] f = -1 f$, y el conmutador vale
\[
  [x,\partial/\partial x] = -1
\]

Cuando la derivada no lleva la misma variable que la coordenada, el conmutador vale cero porque se pueden intercambiar.
Por ejemplo para el conmutador $[x,\partial/\partial y]$, le aplicamos una función $f$
\[
  \left[x,\frac{\partial}{\partial y}\right] f
  =
  x\frac{\partial f}{\partial y} - \frac{\partial }{\partial y} xf
  =
  x\frac{\partial f}{\partial y} - x\frac{\partial }{\partial y} f
  =
  0
\]

Así, el conmutador que buscamos vale cero $[x,\partial/\partial y] = 0$

Generalizando, podemos escribir las siguientes relaciones de conmutación
\begin{align*}
  \left[x,\frac{\partial}{\partial x}\right]
  &=
    \left[y,\frac{\partial}{\partial y}\right]
    =
    \left[z,\frac{\partial}{\partial z}\right]
    =
    -1\\
  \left[x,\frac{\partial}{\partial y}\right]
  \label{eq:cua-conmut-pos-derivada-2}
  &=
    \left[y,\frac{\partial}{\partial z}\right]
    =
    \left[z,\frac{\partial}{\partial x}\right]
    =
    0
\end{align*}
Que se pueden resumir en
\begin{equation}\label{eq:cua-conmut-pos-derivada-delta}
  \left[r_i,\frac{\partial}{\partial r_j}\right]
  = -1\delta_{ij}
\end{equation}

\item Todos los conmutadores que contienen momentos lineales se anulan, debido al
  resultado~(\ref{eq:cua-conmut-derivadas}). Por ejemplo
  \[
    [p_x,p_y]
    =
    \left[
      -i\hbar\frac{\partial}{\partial x},-i\hbar\frac{\partial}{\partial y}
    \right]
    =
    (-i\hbar)^2
    \left[\frac{\partial}{\partial x},\frac{\partial}{\partial y}\right]
    =
    0
  \]

  Resumiendo
  \begin{equation}\label{eq:cua-conmut-momentoslineales}
    [p_i,p_j]
    =
    0
  \end{equation}

\item Ayudándonos de los anteriores, nos ocupamos de los conmutadores posición--momento, como $[x,p_x]$
  \[
    [x,p_x]
    = \left[x,-i\hbar\frac{\partial}{\partial x}\right]
    = -i\hbar \left[x,\frac{\partial}{\partial x}\right]
    = -i\hbar (-1)
    = i\hbar
  \]

  Realizando cálculos similares, los conmutadores posición--momento quedan
  \begin{align*}
    [x,p_x]
    &=
      [y,p_y]
      = [z,P_z]
      = i\hbar\\
    [x,p_y]
    &=
      [y,p_z]
      = [z,P_x]
      = 0
  \end{align*}
  
Las relaciones de conmutación posición-momento se pueden resumir en una expresión
\begin{equation}\label{eq:cua-conmut-posmomento-delta}
  [r_i,p_j] = i\hbar\delta_{ij}
\end{equation}

\item El punto central de esta sección es el cálculo de los conmutadores de momentos
  angulares. Empezaremos por $[L_x,L_y]$
  \begin{align*}
    [L_x,L_y]
    &= [yp_z-zp_y,zp_x-xp_z]\\
    &= [yp_z,zp_x] - [yp_z,xp_z] - [zp_y,zp_x] + [zp_y,xp_z]
  \end{align*}

  Tenemos cuatro conmutadores. Vamos a desarrollar cada uno por separado.
  El primero es $[yp_z,zp_x]$. Vemos que su primer término es la coordenada $y$, que es
  independiente de todos los demás, por lo que podemos quitarla del conmutador por la
  izquierda. Lo mismo le ocurre a $p_x$, que es el último término, por lo que lo
  extraemos por la derecha
  \[
    [yp_z,zp_x]
    =
    y[p_z,z]p_x
    y (-i\hbar) p_x
    = -i\hbar yp_x
  \]

  El resto de conmutadores se calculan a continuación
  \begin{align*}
    [yp_z,xp_z]
    &= y[p_z,x]p_z = 0\\
    [zp_y,zp_x]
    &= z[p_y,z]p_x = 0\\
    [zp_y,xp_z]
    &= x[z,p_z]p_y = x (i\hbar) p_y = i\hbar xp_y
  \end{align*}

  El conmutador $[L_x,L_y]$ queda
  \[
    [L_x,L_y]
    = -i\hbar yp_x + - 0 - 0 + i\hbar xp_y
    = i\hbar (xp_y-yp_x)
    = i\hbar L_z
  \]

  El siguiente conmutador que vamos a estudiar es $[L_x,L_x]$
  \[
    [L_x,L_x]
    = [yp_z,yp_z]
    = y^2[p_z,p_z]
    = 0
  \]

  A continuación tenemos un resumen de conmutadores del momento angular
  \begin{align*}
    [L_x,L_y] &= i\hbar L_z\\
    [L_y,L_z] &= i\hbar L_x\\
    [L_z,L_x] &= i\hbar L_y\\
    [L_x,L_x] &= [L_y,L_y] = [L_z,L_z] = 0
  \end{align*}

  Podemos generalizar estas relaciones y sus opuestas en una fórmula
  \begin{equation}\label{eq:cua-conmut-Lij}
    [L_i,L_j] = i\hbar\epsilon_{ijk}L_k
  \end{equation}
\end{itemize}

Sabemos que el momento angular $\xhat{n}\cdot\vvv{L}$ es el generador de rotaciones, y
también lo es la matriz $\xhat{n}\cdot\vvv{J}$. Si comparamos los conmutadores de estas
magnitudes, ecuaciones~(\ref{eq:cua-conmut-Lij}) y (\ref{eq:cua-conmutacion-v1})
\begin{align*}
  [L_i,L_j] &= i\hbar\epsilon_{ijk}L_k\\
  [\mmm{J}_i,\mmm{J}_j] &= i\epsilon_{ijk} \mmm{J}_k
\end{align*}

Observamos que la relación de conmutación del momento angular contiene el factor $\hbar$,
mientras que el de las matrices $\mmm{J}_i$ no. Lo que se suele hacer en mecánica
cuántica (no en matemáticas) es redefinir las matrices $\mmm{J}$ para que lleven la
constante de Planck, lo que obliga a dividir entre $\hbar$ las demás expresiones donde
apareciera $\mmm{J}$,
como en las ecuaciones~(\ref{eq:cua-nL-v2}) y (\ref{eq:cua-rot-v2}).
Obsérvese que esta última expresión define el operador de rotación de objetos (no es el
de una rotación pasiva) debido al signo negativo en el exponente
\begin{align} 
  \label{eq:cua-J1J2J3-v2}
  &\mmm{J}_1
  = \hbar
    \begin{pmatrix}
      0 & 0 & 0\\
      0 & 0 & -i\\
      0 & i & 0
    \end{pmatrix}
  ;\hspace{.5em}
  \mmm{J}_2
  = \hbar
    \begin{pmatrix}
      0 & 0 & i\\
      0 & 0 & 0\\
      -i & 0 & 0
    \end{pmatrix}
  ;\hspace{.5em}
  \mmm{J}_3
  = \hbar
    \begin{pmatrix}
      0 & -i & 0\\
      i & 0 & 0\\
      0 & 0 & 0
     \end{pmatrix}\\
  \label{eq:cua-JiJj-v2}
  &[\mmm{J}_i,\mmm{J}_j] = i\hbar\epsilon_{ijk} \mmm{J}_k\\
  \label{eq:cua-LiLj-v2}
  &[L_i,L_j] = i\hbar\epsilon_{ijk} L_k\\
  \label{eq:cua-nL-v2}
  &\xhat{n}\cdot\vvv{L}
    = i\,\frac{1}{\hbar}\vvv{r}^\trasp (\xhat{n}\cdot \mmm{J}) \vvv{p}\\
  \label{eq:cua-rot-v2}
  &\mmm{R}(\xhat{n},\theta)
    = \exp\left\{-i\frac{\theta}{\hbar}(\xhat{n}\cdot\mmm{J})\right\}\\
  \label{eq:cua-rotL-v2}
  &\mmm{R}(\xhat{n},\theta)
    = \exp\left\{-i\frac{\theta}{\hbar}(\xhat{n}\cdot\mmm{L})\right\}
\end{align}

Por último, recordemos que la matriz de rotación~(\ref{eq:cua-rot-v2}) define la rotación
de vectores en $\symbb{R}^3$, mientras que (\ref{eq:cua-rotL-v2}) es la matriz de
rotación de funciones en $L^2(\symbb{R}^3)$.

\subsection{Fórmula de Hadamard}
Hacemos un paréntesis para presentar una fórmula que es muy útil y, en particular, la
necesitaremos después para ilustrar la rotación de una derivada parcial más adelante.

Nos proponemos realizar la operación
\begin{equation}\label{eq:cua-hadamard-generica}
  \mmm{E}(\theta)
  =
  e^{-\theta\mmm{A}}\,\vvv{B}\,\,e^{\theta\mmm{A}}
\end{equation}
sin tener que aplicar el desarrollo de Taylor a cada exponencial, con la condición de que
$\mmm{A}$ y $\mmm{B}$ sean independientes de $\theta$.

Desarrollamos $\mmm{E}(\theta)$ en serie de potencias de $\theta$ en un entorno de
$\theta = 0$
\[
  \mmm{E}(\theta)
  =
  \mmm{E}(0) + \mmm{E}'(0)\,\theta + \frac{1}{2!}\,\mmm{E}''(0)\,\theta^2
  + \cdots
\]

Obtenemos el primer sumando del desarrollo, $\mmm{E}(0)$
\[
  \mmm{E}(0)
  = e^{-0}\,\mmm{B}\,\,e^0
  = \mmm{B}
\]

Calculamos la primera derivada de~(\ref{eq:cua-hadamard-generica}) con respecto de
$\theta$, respetando el orden en el que aparecen los operadores $\mmm{A}$ y $\mmm{B}$
porque en general no podemos intercambiarlos, a menos que conmuten
\begin{align*}
  \mmm{E}'(\theta)
  &=
    -\mmm{A}\,e^{-\theta\mmm{A}}\,\mmm{B}\,\,e^{\theta\mmm{A}}
    + e^{-\theta\mmm{A}}\,\mmm{B}\,\,e^{\theta\mmm{A}}\mmm{A}
    = -\mmm{A}\mmm{E} + \mmm{E}\mmm{A}
    = [\mmm{E},\mmm{A}]\\
  \mmm{E}'(0)
  &=
    [\mmm{E}(0),\mmm{A}]
    = [\mmm{B},\mmm{A}]
\end{align*}

La segunda derivada
\begin{align*}
  \mmm{E}''(\theta)
  &=
    -\mmm{A}\mmm{E}' + \mmm{E}'\mmm{A} = [\mmm{E}',\mmm{A}]
    = \left[[\mmm{E},\mmm{A}],\mmm{A}\right]\\
  \mmm{E}''(0)
  &=
    \left[[\mmm{E}(0),\mmm{A}],\mmm{A}\right]
    =
    \left[[\mmm{B},\mmm{A}],\mmm{A}\right]
\end{align*}

La tercera derivada
\begin{align*}
  \mmm{E}'''(\theta)
  &=
    -\mmm{A}\mmm{E}'' + \mmm{E}''\mmm{A} = [\mmm{E}'',\mmm{A}]
    = \left[\left[[\mmm{E},\mmm{A}],\mmm{A}\right],\mmm{A}\right]\\
  \mmm{E}'''(0)
  &=
    \left[\left[[\mmm{B},\mmm{A}],\mmm{A}\right],\mmm{A}\right]
\end{align*}
Y así sucesivamente.

Sustituimos estas derivadas en~(\ref{eq:cua-hadamard-generica}) y obtenemos la fórmula de
Hadamard
{\small
\begin{equation}\label{eq:cua-hadamard-formula}
  e^{-\theta\mmm{A}}\,\mmm{B}\,e^{\theta\mmm{A}}
  = \mmm{B} + [\mmm{B},\mmm{A}]\,\theta
  + \frac{1}{2!}\,
  \left[[\mmm{B},\mmm{A}],\mmm{A}\right]\,\theta^2
  + \frac{1}{3!}\,
  \left[\left[[\mmm{B},\mmm{A}],\mmm{A}\right],\mmm{A}\right]\,\theta^3
  + \cdots
\end{equation}


\section{Representaciones del momento angular}
Para rotar una función de onda $\Psi(x,y,z)$ definida en $\symbb{R}^3$, hemos de utilizar
los generadores $\vvv{L}$, que cumplen las siguientes relaciones de conmutación
\[
  [L_i,L_j] = i\hbar\epsilon_{ijk}L_k
\]

En cambio, si quisiéramos rotar un vector en $\symbb{R}^3$, utilizaremos los generadores
$\vvv{J}$ con las mismas relaciones de conmutación
\[
  [J_i,J_j] = i\hbar\epsilon_{ijk}J_k
\]

Ser un momento angular es \emph{tener una vida dedicada a rotar cosas}.
Es como si hubiera un único momento angular y según el mundo al que baje adoptara una
forma u otra. Se podría comportar como $\vvv{L}$, como $\vvv{J}$ o como $\vvv{S}$.
Estas son diferentes representaciones del momento angular.

En mecánica clásica no hay problema con el momento angular, se define como ya sabemos, y
no hay nada más profundo en el concepto
\[
  \vvv{L} = \vvv{r}\prodvec\vvv{p}
\]

En cambio en mecánica cuántica, si queremos rotar funciones de onda (espacio de funciones
$L^2\left(\symbb{R}^3\right)$) utilizaremos el operador diferencial de rotación
\[
  \mmm{R}(\theta) = e^{-i\frac{\theta} {\hbar} (\xhat{n}\cdot\vvv{L})}
\]

Pongamos un ejemplo. Si quisiéramos rotar una función de onda $\Psi(x,y,z)$ alrededor del
eje $z$, necesitaríamos la componente $L_z$ del momento angular.
Utilizamos la igualdad~\eqref{eq:cua-nL-v2}
\[
  \xhat{n}\cdot\vvv{L}
  =
  \frac{i}{\hbar}\vvv{r}^\dagger
  (\xhat{n}\cdot\vvv{J})\, \vvv{p}
\]

Haríamos que $\xhat{n}$ fuera el vector $(0,0,1)$ y como estamos en el espacio de
funciones $L^2\left(\symbb{R}^3\right)$ y hacemos $\vvv{p} = -i\hbar\vvv{\nabla}$
\begin{align*}
  L_z
  &=
    \frac{i}{\hbar}
    \begin{pmatrix}
      x & y & z
    \end{pmatrix}
    \left[
    \begin{pmatrix} 0 & 0 & 1 \end{pmatrix}
    \begin{pmatrix} J_1 \\ J_2 \\ J_3 \end{pmatrix}
    \right]
    \begin{pmatrix} p_x \\ p_y \\ p_z\end{pmatrix}
    =
    \frac{i}{\hbar}
    \begin{pmatrix}
      x & y & z
    \end{pmatrix}
    \mmm{J}_3
    \begin{pmatrix}
      p_x \\ p_y \\ p_z
    \end{pmatrix}\\
  &= \frac{i}{\cancelout{\hbar}}
    \begin{pmatrix}
      x & y & z
    \end{pmatrix}
    i\cancelout{\hbar}
    \begin{pmatrix}
      0 & -1 & 0\\
      1 & 0 & 0\\
      0 & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
      p_x \\ p_y \\ p_z
    \end{pmatrix}
    =
    -\begin{pmatrix} x & y & z\end{pmatrix}
    \begin{pmatrix} -p_y \\ p_x \\ 0 \end{pmatrix}\\
  &=
    xp_y-yp_x
    =
    x\,\left(-i\hbar\,\frac{\partial}{\partial y}\right)
    - y\,\left(-i\hbar\,\frac{\partial}{\partial x}\right)
    =
    -i\hbar
    \left(x\,\frac{\partial}{\partial y} - y\,\frac{\partial}{\partial x}\right)
\end{align*}

Vemos que el generador de la rotación es un operador diferencial. En este espacio de
funciones, el momento angular adopta la representación de un operador diferencial.
Si aplicamos $L_z$ a una función $\Psi(x,y,z)$, tendríamos
\[
  L_z\Psi
  =
  -i\hbar \left(%
    x\,\frac{\partial\Psi}{\partial y}
    - y\,\frac{\partial\Psi}{\partial x}
  \right)
\]

Una función se rotaría aplicándole el operador de rotación
\[
  R(\xhat{n},\theta)
  =
  e^{-i\frac{\theta}{\hbar}\,(\xhat{n}\cdot\vvv{L})}
\]
\[
  \tilde{\Psi}
  =
  e^{-i\frac{\theta}{\hbar}\,(\xhat{n}\cdot\vvv{L})} \,\Psi
\]

En cambio, si estuviéramos en el espacio $\symbb{C}^3$, los objetos serían vectores del
tipo
\[
  \begin{pmatrix}
    a_1 \\ a_2 \\ a_3
  \end{pmatrix}
  ;\hspace{1em}
  \text{con }
  a_i\in\symbb{C}
\]

Para rotar este tipo de vectores utilizaríamos el operador
\[
  R(\xhat{n},\theta)
  =
  e^{-i\frac{\theta}{\hbar}\,(\xhat{n}\cdot\mmm{J})}
\]

Si quisiéramos rotar estos vectores alrededor del eje $z$, el operador se transformaría
en la matriz que ya nos es familiar
\[
  R_z(\theta)
  =
  \begin{pmatrix}
    \cos\theta & -\sin\theta & 0\\
    \sin\theta & \cos\theta & 0\\
    0 & 0 &1
  \end{pmatrix}
\]

El operador que gira vectores en $\symbb{C}^3$ es una matriz, mientras que en el caso de
la rotación de funciones era un operador diferencial.
Lo importante es entender que ambos se encargan de rotar objetos de distinta naturaleza.

Todas las representaciones de la rotación tienen un invariante.
En el caso de las funciones el valor de la función debe ser el mismo, tanto en la función
original como en la rotada; en la rotación de vectores el invariante es el módulo de los
vectores.

Vemos que el momento angular es único, pero tiene diferentes reprsentaciones,
una en el espacio de funciones $L^2\left(\symbb{R}^3\right)$, otra en el espacio
$\symbb{C}^3$, o en $\symbb{R}^3$, etc.

El momento angular también puede girar vectores en otros espacios, como en $\symbb{C}^2$.
Lo que permite girar vectores en este espacio es el spin 1/2.
Así, el spin 1/2 es la representación del momento angular en el espacio $\symbb{C}^2$,
mientras que el spin 3/2 es su representación en el espacio $\symbb{C}^3$.

También podemos decir que el spin 1/2 es el generador de las rotaciones en $\symbb{C}^2$
y el spin 3/2 es el generador de las rotaciones en $\symbb{C}^3$.

\subsection{Concepto de representación del momento angular}
Cualquier objeto $\vvv{A} = (A_1, A_2, A_3)$ que se comporte como un vector bajo rotaciones y que cumpla las relaciones de conmutación $[A_i,A_j] = i\epsilon_{ijk}A_k$ es
una representación del momento angular y genera las rotaciones en el espacio
\emph{donde vive} mediante el operador
\[
  \mmm{R}(\xhat{n},\theta)
  =
  e^{-i\frac{\theta}{\hbar}\,\xhat{n}\cdot\vvv{A}}
\]

\subsection{¿Qué es ser un vector bajo rotaciones?}
Responderemos a esta pregunta mediante un ejemplo.
Sabemos que el gradiente de una función en coordenadas cartesianas es
\[
  \vvv{\nabla} f
  =
  \left(
    \frac{\partial f}{\partial x},
    \frac{\partial f}{\partial y},
    \frac{\partial f}{\partial z}\right)
\]

El operador gradiente en estas coordenadas está formado por las tres derivadas parciales
respectivas
\[
  \vvv{\nabla}
  =
  (\partial_x, \partial_y, \partial_z)
\]
donde $\partial_k$ es abreviatura de $\partial/\partial k$.

Sabemos por los textos de física y matemáticas que al gradiente se le considera un
vector, y es frecuente expresarlo como
\[
  \vvv{\nabla}
  = \frac{\partial}{\partial x}\,\xhat{i}
  + \frac{\partial}{\partial y}\,\xhat{j}
  \frac{\partial}{\partial z}\,\xhat{k}
\]

Un objeto, en este caso el operador gradiente será un \emph{vector bajo rotaciones} si al
rotar se comportara exactamente como los vectores.

Como excusa para poder responder a la pregunta, vamos a rotar una derivada y, de paso,
para añadir algo de emoción plantearemos el siguiente problema
\begin{quote}
  \emph{Se supone que sabemos como realizar la derivada parcial de una función con
    respecto de $x$, pero no tenemos ni idea de calcularla con respecto de $y$.}
\end{quote}

Nos vamos a ayudar de la figura~\ref{fig:cua-gradiente}. En la parte izquierda se
representa una función de forma abstracta ---de hecho no se muestra explícitamente---;
en su lugar se presentan en gris las variables de la función como si fueran vectores,
cuya resultante nos da un punto de la función abstracta definida en $\symbb{R}^3$.
Estas variables se corresponden, como no podía ser de otra manera, con los ejes de
coordenadas, en negro, para la función original.

Como no sabemos calcular la derivada parcial con respecto de $y$ ---el vector en gris que
representa a esta variable se traza con mayor grosor---, pero sí calcular $\partial_x$,
rotamos \ang{-90} la función alrededor del eje $z$, como se observa en la parte derecha
de la figura, consiguiendo que la variable $y$ se transforme temporalmente en la nueva
variable $x$ de la función rotada.
\begin{figure}[ht]
\def\scl{0.78}
\def\longeje{3}
%
\tdplotsetmaincoords{60}{110}
% 
\pgfmathsetmacro{\RVEC}{\longeje}
\pgfmathsetmacro{\thetavec}{90}
\pgfmathsetmacro{\phivec}{90}
%
\pgfmathsetmacro{\xvec}{0}
\pgfmathsetmacro{\yvec}{\longeje}
\pgfmathsetmacro{\zvec}{\longeje}
% Fondo
\pgfmathsetmacro{\HORZ}{0.25}
\pgfmathsetmacro{\VERT}{0.25}
%
\centering
\begin{tikzpicture}[
  scale=\scl,
  tdplot_main_coords,
  % Vector original
  vectororig/.style={-{Latex[round]}, line width=1pt, \colorVorig},
  vectororigampl/.style={-{Latex[round]}, \colorVorig, line width=2pt},
  textoorig/.style={\colorTorig},
  % Vector rotado
  vectorrot/.style={-{Latex[round]}, line width=1pt, \colorVrot},
  vectorrotampl/.style={-{Latex[round]}, \colorVrot, line width=2pt},
  textorot/.style={\colorTrot},
  background/.style={
    line width=\bgborderwidth,
    draw=\bgbordercolor,
    fill=\bgcolor,
  },
%  backgroundonly/.style={%
%    line width=\bgborderwidth,
%    fill=\bgcolor,
%  },
  ]
  \coordinate (dx) at (1.8,0,0);
  \coordinate (dy) at (0,1.8,0);
  \coordinate (dz) at (0,0,1.8);
  \draw[thick,->] (0,0,0) -- (\longeje,0,0) node[anchor=north east]{$x$} coordinate (x);
  \draw[thick,->] (0,0,0) -- (0,\longeje,0) node[below right=-5pt and 0pt]{$y$};
  \draw[thick,->] (0,0,0) -- (0,0,\longeje) node[anchor=south]{$z$};
  \draw[vectororig] (0,0,0) -- (dx);
  \node[above left,textoorig] at (dx) {\small $\vvv{x}$};
  \draw[vectororigampl] (0,0,0) -- (dy); 
  \node[above,textoorig] at (dy) {\small $\vvv{y}$};
  \draw[vectororig]  (0,0,0) -- (dz);
  \node[left,textoorig] at (dz) {\small $\vvv{z}$};

  \tdplotsetcoord{P}{\RVEC}{\thetavec}{\phivec}
  \tdplotdrawarc[latex-]{(0,0,0)}{0.8}{0}{\phivec}{anchor=north} {$\ang{-90}$}

  % REPRESENTACIÓN DEL GIRO ALREDEDOR DEL EJE Z
  % \tdplotsetthetaplanecoords{-90}
  % Notice you have to tell tiks-3dplot you are now in rotated coords
  % Since tikz-3dplot swaps the planes in tdplotsetthetaplanecoords,
  % the former y axis is now the z axis.
  \tdplotdrawarc[line width=2.25pt,
  -{Latex[round,length=15pt,width=7.7pt,bend]},color=black!30]
  {(0,0,2.3)}{0.35}{290}{-25}{anchor=south west,color=black}{}
  % Reponer parte final del eje z para simular perspectiva
  \draw[thick,->] (0,0,2.3) -- (0,0,\longeje);
  
  \begin{scope}[xshift=4cm]
    \draw[-{Latex}] (0,0,0) --
    node[above] {\small Giro activo}
    node[below] {\small $\ang{-90}$ eje $z$}
    +(right:2.5cm);
  \end{scope}

  \begin{scope}[xshift=9cm]
    \coordinate (ddx) at (0,-1.8,0);
    \coordinate (ddy) at (1.8,0,0);
    \coordinate (ddz) at (0,0,1.8);
    \draw[thick,->] (0,0,0) -- (\longeje,0,0) node[anchor=north east]{$x$} coordinate (x);
    \draw[thick,->] (0,0,0) -- (0,\longeje,0) node[below right=-5pt and 0pt]{$y$};
    \draw[thick,->] (0,0,0) -- (0,0,\longeje) node[anchor=south]{$z$};
    \draw[vectorrotampl] (0,0,0) -- (ddy);
    \node[below right=-3pt and 3pt,textorot] at (ddy) {$\xtilde{y}$};
    \draw[line width=1pt, -{Latex[round]}, red!80!black] (0,0,0) -- (ddx);
    \node[above,textorot] at (ddx) {$\xtilde{x}$}; 
    \draw[line width=1pt, -{Latex[round]}, red!80!black] (0,0,0) -- (ddz);
    \node[left,red!80!black] at (ddz) {$\xtilde{z}$};
  \end{scope}

  % Fondo amarillo
  \coordinate (SW) at ($(current bounding box.south west) + (-\HORZ cm,-\VERT cm)$);
  \coordinate (NE) at ($(current bounding box.north east) + (\HORZ cm,\VERT cm)$);    
  \begin{scope}[on background layer]
    \draw[background] (SW) rectangle (NE);
  \end{scope}
\end{tikzpicture}
\caption{Se representan de forma abstracta en rojo las variables de la función que se va
  a rotar \ang{-90}. El eje $y$ de la función original se traza con mayor grosor para
  distinguirlo de los demás. Los ejes cartesianos fijos se muestran en negro.
  Al girar la función, la antigua variable $y$ se ha transformado en la nueva variable
  $x$, que sabemos derivar según hemos supuesto.}
\label{fig:cua-gradiente}
\end{figure}

Los siguientes pasos que ya no se representan en la figura son: Se deriva esta función
rotada con respecto de $x$ --recordemos que es la $y$ original-- y finalmente, se
volvería a rotar la función derivada--ahora \ang{+90}-- para restablecer la orientación
original, o en otras palabras, la correspondencia original de variables y ejes de
coordenadas\footnotemark{}.
\footnotetext{El lector atento se habrá dado cuenta de que es mejor aprender a derivar
  parcialmente con respecto a $y$ que calcular la derivada mediante rotaciones.}

Como queremos rotar una función, el generador de la rotación es
$\vvv{L}$
\[
  \mmm{R} = e^{-i\frac{\theta}{\hbar} (\xhat{n}\cdot\vvv{L})}
\]

Rotamos alrededor del eje $z$
\[
  \xhat{n}\cdot\vvv{L}
  =
  \begin{pmatrix}
    0 & 0 & 1
  \end{pmatrix}
  \begin{pmatrix}
    Lx\\
    Ly\\
    Lz
  \end{pmatrix}
  =
  L_z
\]

Así, el operador de rotación que aplicaremos a la función será
\[
  \mmm{R}_z = e^{-i\frac{\theta}{\hbar} L_z}
\]

Desglosamos las operaciones que vamos a realizar con la función $f(x,y,z)$:
\begin{itemize}
\item Primero rotamos la función en torno al eje $z$ un ángulo de
  $-\pi/2\,\si{\radian}$. El generador de la rotación es $L_z$
  \[
    \mmm{R}_z(-\pi/2)\,f
    =
    e^{-i\frac{-\pi/2}{\hbar}\,L_z} f(x,y,z)
    =
    e^{i\frac{\pi/2}{\hbar}\,L_z} f(x,y,z)
  \]
  
\item Luego derivamos la función rotada con respecto a $x$
  \[
    \partial_x\left[\mmm{R}_z(-\pi/2)\, f\right]
    =
    \frac{\partial}{\partial x}
    \left[
      e^{i\frac{\pi/2}{\hbar}\,L_z} f(x,y,z)
    \right]
  \]

\item Por último, restablecemos la orientación de las variables rotando el resultado
  alrededor del eje $z$ un ángulo de $+\pi/2\,\si{\radian}$
  \[
    \mmm{R}_z(\pi/2)\left\{\partial_x\left[\mmm{R}_z(-\pi/2)\, f\right]\right\}
    =
    e^{-i\frac{\pi/2}{\hbar}\,L_z}
    \left\{
      \frac{\partial}{\partial x}
      \left[
        e^{i\frac{\pi/2}{\hbar}\,L_z} f(x,y,z)
      \right]
    \right\}
  \]
\end{itemize}

Podemos resumir las operaciones como la aplicación a la función $f$, del operador
\[
  \mmm{R}_z(\pi/2)\,\partial_x\,\mmm{R}_z(-\pi/2)
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,\frac{\partial}{\partial x}\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\]

Vamos a demostrar que el operador equivale a la derivada parcial con respecto de $y$
\begin{equation}\label{eq:cua-parcial-y-rotando}
  \frac{\partial}{\partial y}
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,\frac{\partial}{\partial x}\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\end{equation}

Multiplicamos por $-i\hbar$ los dos miembros de la igualdad
\[
  -i\hbar\,\frac{\partial}{\partial y}
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,\left(-i\hbar\,\frac{\partial}{\partial x}\right)\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\]

Así, demostrar~\eqref{eq:cua-parcial-y-rotando} equivale a demostrar
\begin{equation}\label{eq:cua-py-px}
  p_y
  =
  \mmm{R}_z(\pi/2)\,\,p_x\,\mmm{R}_z(-\pi/2) 
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,p_x\,\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\end{equation}
Hemos pasado las derivadas parciales a componentes del momento lienal porque, conocer las
relaciones de conmutación entre $p_x$ y $L_z$ nos va a facilitar enormemente la
demostración, e incluso poder generalizar el resultado.

\subsubsection{Demostrando que
  \mathinhead{p_y=R_z(\pi/2)\,\,p_x\,R_z(-\pi/2)}{pyop}}
Nos interesa expresar temporalmente el operador en función de
$\theta = \pi/2\,\si{\radian}$
\[
  e^{-i\frac{\theta}{\hbar}\,L_z} \, p_x \, e^{i\frac{\theta}{\hbar}\,L_z}
\]

Comparamos el operador que queremos calcular~(\ref{eq:cua-py-px}) con el que hace
referencia la fórmula de Hadamard~(\ref{eq:cua-hadamard-formula})
\begin{align*}
  e^{-\theta\mmm{A}}\,\mmm{B}\,e^{\theta\mmm{A}}
  =
  e^{-i\frac{\theta}{\hbar}\,L_z} \,(p_x)\,
  e^{i\frac{\theta}{\hbar}\,L_z}
\end{align*}
Vemos que
\[
  \mmm{A} = \frac{i}{\hbar}\,L_z
  ;\hspace{1em}
  \vvv{B} = p_x
  ;\hspace{1em}
  \theta = \frac{\pi}{2}\,\si{\radian}
\]

Ahora podemos calcular los conmutadores de la fórmula de Hadamard
\begin{align*}
  &[\mmm{B},\mmm{A}]
  =
    [p_x,\frac{i}{\hbar}\,L_z]
    = \frac{i}{\hbar} [p_x,L_z]
    = \frac{i}{\hbar}[p_x,xp_y-yp_x]
    = \frac{i}{\hbar}
    \left\{
    [p_x,xp_y] - [p_x,yp_x]
  \right\}\\
  &\hspace{2.8em}=
    \frac{i}{\hbar}
    \left\{
    [p_x,x]p_y - y\cancelout{[p_x,p_x]}
    \right\}
    = \frac{i}{\hbar}\,(-i\hbar)\,p_y
    = p_y\\
\end{align*}
\begin{align*}
  \left[[\mmm{B},\mmm{A}],\mmm{A}\right]
  &=
    [p_y,\mmm{A}]
    =
    [p_y,\frac{i}{\hbar}L_z]
    = \frac{i}{\hbar}[p_y,xp_y-yp_x]
    = \frac{i}{\hbar}
    \left\{
    [p_y,xp_y] - [p_y,yp_x]
    \right\}\\
  &=
    \frac{i}{\hbar}
    \left\{
    x\cancelout{[p_y,p_y]} - [p_y,y] p_x
    \right\}
    = -\frac{i}{\hbar}\,(-i\hbar)\,p_x
    = -p_x
\end{align*}

Calculamos nuestro operador
\begin{align*}
  \mmm{E}(\theta)
  &=
    p_x + p_y\,\theta + \frac{1}{2!}[P_y,\mmm{A}]\,\theta^2
    + \frac{1}{3!}[-p_x,\mmm{A}]\,\theta^3
    + \frac{1}{4!}[-p_y,\mmm{A}]\,\theta^4 + \cdots\\
  &=
    p_x + p_y\,\theta + \frac{1}{2!}\,(-p_x)\,\theta^2
    + \frac{1}{3!}\,(-p_y)\,\theta^3
    + \frac{1}{4!}\,(p_x)\,\theta^4 + \cdots\\
  &=
    \left(1-\frac{\theta^2}{2!}+\frac{\theta^4}{4!}+\cdots\right) p_x
    + \left(\theta-\frac{\theta^3}{3!} + \cdots\right) p_y\\
  &=
    p_x \cos\theta + p_y \sin\theta
\end{align*}

Sustituimos $\theta$ por $\pi/2$
\[
  \mmm{E}(\pi/2)
  = p_x \cos(\pi/2) + p_y \sin(\pi/2)
  = p_y
\]

Hemos demostrado~(\ref{eq:cua-py-px})
\[
  p_y
  =
  \mmm{R}_z(\pi/2)\,(p_x)\,\mmm{R}_z(-\pi/2) 
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,(p_x)\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\]
\[
  -i\hbar\frac{\partial}{\partial y}
  =
  \mmm{R}_z(\pi/2)\,(p_x)\,\mmm{R}_z(-\pi/2) 
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,\left(-i\hbar\frac{\partial}{\partial x}\right)\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\]

Hemos comprobado que podemos derivar parcialmente con respecto de $y$ sólo sabiendo
derivar con respecto de $x$
\[
  \frac{\partial}{\partial y}
  =
  \mmm{R}_z(\pi/2)\,(p_x)\,\mmm{R}_z(-\pi/2) 
  =
  e^{-i\frac{\pi/2}{\hbar}\,L_z} \,\left(\frac{\partial}{\partial x}\right)\,
  e^{i\frac{\pi/2}{\hbar}\,L_z}
\]

Pero el problema anterior era sólo una excusa para probar que el gradiente se comporta
como un vector bajo rotaciones; la primera igualdad ya la hemos demostrado y las demás se
podrían obtener de forma similar
\begin{align*}
  \left(\frac{\partial}{\partial x}\right)'
  &= \sin\theta\,\frac{\partial}{\partial x}
    + \cos\theta\,\frac{\partial}{\partial y}\\
  \left(\frac{\partial}{\partial y}\right)'
  &= -\sin\theta\,\frac{\partial}{\partial x}
    + \cos\theta\frac{\partial}{\partial y}\\
  \left(\frac{\partial}{\partial z}\right)'
  &= \frac{\partial}{\partial z}
\end{align*}
lo que demuestra que el operador gradiente se transforma como vectores bajo rotación.

Un comentario para terminar, el gradiente $\vvv{\nabla}$ es un vector, pero como sus
componentes no cumplen las relaciones de conmutación apropiadas, no es un momento angular.
Pero $\vvv{L}$ se comporta como un vector bajo rotaciones y sus componentes sí cumplen
las relaciones de conmutación, por lo que sí es un momento angular.





  
%%% Local Variables:
%%% mode: latex
%%% TeX-engine: luatex
%%% TeX-master: "../gruposlie.tex"
%%% End:
 
