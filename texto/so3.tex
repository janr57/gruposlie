% so3.tex
%
% Copyright (C) 2022, 2023, 2024 José A. Navarro Ramón <janr.devel@gmail.com>
% Licencia Creative Commons Recognition Share-alike.
% (CC-BY-SA)

\chapter{El grupo de rotaciones SO(3)}
En este capítulo estudiaremos el grupo de rotaciones en el espacio tridimensional.
Partimos de la expresión exponencial de la matriz de  rotación de los ejes $x$ e $y$ en dos dimensiones en sentido antihorario
 \[
   \mmm{R} (\theta)
   = e^{\theta\mmm{G}}
   = \exp\left\{\theta\,\begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix}\right\}
 \]
 siendo $\mmm{G}$ el único generador de rotación en el grupo SO(2).
 
\subsection{Número de generadores del grupo SO(3)}\label{subsec:num_gen_so3}
Para saber cuántos generadores encontraremos en el grupo SO(3), nos debemos fijar en la expresión exponencial de una rotación en el espacio tridimensional
\[
  \mmm{R} = e^{\mmm{A}} = \exp\left\{
    \begin{pmatrix}
      A_{11} & A_{12} & A_{13}\\ A_{21} & A_{22} & A_{23}\\ A_{31} &
      A_{32} & A_{33}
    \end{pmatrix}\right\}
\]

Sabemos que la matriz $\mmm{A}$ debe ser antisimétrica:
\begin{itemize}
\item Los elementos diagonales deben ser cero, $A_{ii} = 0$
\[
    \mmm{A} =
    \begin{pmatrix}
      0 & A_{12} & A_{13}\\
      A_{21} & 0 & A_{23}\\
      A_{31} & A_{32} & 0
    \end{pmatrix}
\]

\item Los elementos que están fuera de la diagonal deben cumplir
  $A_{ij} = -A_{ji}$
  \[
    \mmm{A} =
    \begin{pmatrix}
      0 & A_{12} & A_{13}\\
      -A_{12} & 0 & A_{23}\\
      -A_{13} & -A_{23} & 0
    \end{pmatrix}
\]
\end{itemize}

Vemos que sólo tenemos tres grados de libertad: $A_{12}$, $A_{13}$ y
$A_{23}$, los demás elementos quedan completamente especificados.
Este grupo tendrá tres generadores.

Dejamos, como ejercicio, comprobar que una rotación en el plano --SO(2)-- tiene un único generador, mientras que una rotación en el espacio de cuatro dimensiones --SO(4)--, tiene seis.

\subsection{Generador para la rotación alrededor del eje
  \mathinhead{z}{z}, \mathinhead{\mmm{G}_z}{Gz}}
Esta rotación pasiva hace girar los ejes $x$ e $y$ de forma similar a como hemos visto
en la SO(2), así que la podemos relacionar con una rotación alrededor del eje $z$ en
tres dimensiones
\[
  \mmm{R}_z (\theta) = \exp\left\{\theta\,\begin{pmatrix} 0 & 1 \\ -1
      & 0 \end{pmatrix}\right\}
\]

Pero el generador debe ser una matriz $3\times 3$, por lo que se debe completar.
Como la matriz debe ser antisimétrica, los elementos diagonales deben ser cero
\[
  \mmm{R}_z (\theta) = \exp\left\{ \theta\,
    \begin{pmatrix}
      0 & 1 \\ -1
      & 0 \\ & & 0
    \end{pmatrix} \right\}
\]

Completamos con ceros el resto de elementos
\[
  \mmm{R}_z (\theta) = \exp\left\{ \theta\,
    \begin{pmatrix}
      0 & 1 & 0 \\ -1 & 0 & 0\\ 0 & 0 & 0
    \end{pmatrix}\right\}
\]
y el generador para la rotación pasiva alrededor del eje $z$ sería
\begin{equation}\label{eq:so3-generador_z}
  \mmm{G}_z =
  \begin{pmatrix} 0 & 1 & 0
    \\ -1 & 0 & 0\\ 0 & 0 & 0
  \end{pmatrix}
\end{equation}

Debido a la forma un poco arbitraria con que hemos obtenido este generador, tenemos que comprobar que describe efectivamente una rotación alrededor del eje $z$.
Lo más sencillo es comprobarlo mediante una rotación infinitesimal, porque la matriz de rotación es más sencilla, dado que los términos que contienen $\varepsilon^n$ con $n>=2$ son despreciables
\begin{equation}
  \label{eq:so3-rotacion_infinitesimal_z}
  \mmm{R}_z (\varepsilon) \approx
  \mmm{I} + \varepsilon\, \mmm{G}_z
  = \begin{pmatrix}
    1 & 0 & 0\\
    0 & 1 & 0\\
    0 & 0 & 1
  \end{pmatrix}
  + \varepsilon
  \begin{pmatrix}
    0 & 1 & 0 \\ -1 & 0 & 0\\ 0 & 0 & 0
  \end{pmatrix}
\end{equation}

Aplicamos esta pequeña rotación pasiva alrededor del eje $z$ a un
vector cualquiera del espacio de tres dimensiones
{
  \small
  \begin{align*}
   \begin{pmatrix}
     x' \\ y' \\ z'
   \end{pmatrix}
   &= \mmm{R}_z (\varepsilon)
   \begin{pmatrix}
     x \\ y \\ z
   \end{pmatrix}
   \approx
   \left[
   \begin{pmatrix}
     1 & 0 & 0\\
     0 & 1 & 0\\
     0 & 0 & 1
   \end{pmatrix}
   + \varepsilon
   \begin{pmatrix}
     0 & 1 & 0 \\ -1 & 0 & 0\\ 0 & 0 & 0
   \end{pmatrix}
  \right]\,
  \begin{pmatrix}
    x \\ y \\ z
  \end{pmatrix}\\
   &=
  \begin{pmatrix}
    x \\ y \\ z
  \end{pmatrix}
  + \varepsilon
  \begin{pmatrix}
    y \\ -x \\ 0
  \end{pmatrix}
  =
     \begin{pmatrix}
    x+\varepsilon y \\ y-\varepsilon x \\ z
  \end{pmatrix}
  \end{align*}
}

Calculamos las componentes después del giro de los ejes alrededor del
eje $z$
\begin{subequations}\label{eq:so3-giro_z_incxyz}
\begin{align}
  \label{eq:so3-giro_z_incx}
  x' &= x + \varepsilon y\\
  \label{eq:so3-giro_z_incy}
  y' &= y - \varepsilon x\\
  \label{eq:so3-giro_z_incz}
  z' &= z
\end{align}
\end{subequations}

¿Cómo podemos saber que estas transformaciones de las coordenadas son
compatibles con un giro pasivo infinitesimal alrededor del eje $z$?
Aunque no es una demostración definitiva, podemos comprobarlo
fijándonos en que un giro antihorario de los ejes $x$ e $y$ alrededor
del ejx $z$, es equivalente a un giro horario del espacio (en este
caso el punto $P$), dejando los ejes inalterados, como se puede
observar a la izquierda de la figura \ref{fig:so3-giros_zxy}.

Tal y como se aprecia en las ecuaciones \eqref{eq:so3-giro_z_incx},
\eqref{eq:so3-giro_z_incy} y \eqref{eq:so3-giro_z_incz},
a la izquierda de la figura \ref{fig:so3-giros_zxy},
la coordenada $x'$ del punto girado debe aumentar ligeramente,
la coordenada $y'$ disminuir, también ligeramente, mientras que la
coordenada $z'$ se mantiene constante.
\begin{figure}[ht]
  % Escala
  \def\scl{.78}
  \centering
  \begin{minipage}{0.31\linewidth}
    % Eje x
    \pgfmathsetmacro{\XMLONG}{0}
    \pgfmathsetmacro{\XPLONG}{3}
    % Eje y
    \pgfmathsetmacro{\YMLONG}{0}
    \pgfmathsetmacro{\YPLONG}{3}
    % Ángulo rotado
    \pgfmathsetmacro{\ANGROT}{20}
    % Vector P
    \pgfmathsetmacro{\PMOD}{2.5}
    \pgfmathsetmacro{\PANG}{60}
    % Vector P'
    \pgfmathsetmacro{\PPRIMAMOD}{\PMOD}
    \pgfmathsetmacro{\PPRIMAANG}{\PANG - \ANGROT}
    % 
    \centering
    \begin{tikzpicture}[%
      scale=\scl,
      every node/.style={black,font=\small},
      eje/.style={->},
      vector/.style={-{Latex}, shorten >=1.2pt, line width=.8pt},
      vectorrotado/.style={vector, draw=green!50!black},
      pcirculo/.style={fill=red, draw=black},
      pprimacirculo/.style={green!90!black, draw=black},
      background/.style={
        line width=\bgborderwidth,
        draw=\bgbordercolor,
        fill=\bgcolor,
      },      
      ]
      % Coordenadas
      \coordinate (O) at (0,0);
      \coordinate (under_origin) at (0,-3mm);
      \coordinate (left_origin) at (-3mm,0);
      \coordinate (xini) at (-\XMLONG cm,0);
      \coordinate (xfin) at (\XPLONG cm,0);
      \coordinate (yini) at (0,-\YMLONG cm);
      \coordinate (yfin) at (0,\YPLONG cm);
      \coordinate (P) at (\PANG:\PMOD cm);
      \coordinate (P') at  (\PPRIMAANG:\PPRIMAMOD);
      \path (O) -- coordinate (OPmidway) (P);
      \path (O) -- coordinate (OP'midway) (P');
      \path (O) -- coordinate[pos=1.2] (parrow) (P);
      \path (O) -- coordinate[pos=1.2] (p'arrow) (P');
      % Ángulo \varepsilon
      \path (P') -- (O) -- (P) pic
      [draw=black!50!,fill=green!20,"\footnotesize $\varepsilon$",angle
      radius=6mm, angle eccentricity=1.5] {angle = P'--O--P};
      % Ejes
      \draw[eje] (xini) -- (xfin);
      \node[right, name=letraejex] at (xfin) {$x$};
      \draw[eje] (yini) -- (yfin);
      \node[above, name=letraejey] at (yfin) {$y$};
      % Punto P
      \draw[vector] (O) -- (P);
      \node[above=5pt] at (OPmidway) {$\vvv{r}$};
      \fill[pcirculo] (P) circle [radius=1.4pt];
      \node[above] at (P) {$P$};
      % Punto P'
      \draw[vectorrotado] (O) -- (P');
      \node[right=0pt] at (OP'midway) {$\vvv{r}'$};
      \fill[pprimacirculo] (P') circle [radius=1.4pt];
      \node[right] at (P') {$P'$};
      % Sentido de giro del vector
      \draw [-{Latex},green!40!black,shorten <= 3pt]
      (parrow) to[bend left=30] (p'arrow);
      % Incremento x
      \draw[fill=red,draw=black] (P |- O) circle[radius=1.5pt];
      \draw[fill=green!80!black,draw=black] (P' |- O)
      circle[radius=1.5pt];
      \draw[-{Latex}] (P |- under_origin) --
      node[below,name=incx] {\scriptsize $\Delta x > 0$} (P' |- under_origin);
      % Incremento y
      \draw[fill=red,draw=black] (P -| O) circle[radius=1.5pt];
      \draw[fill=green!80!black,draw=black] (P' -| O)
      circle[radius=1.5pt];
      \draw[-{Latex}] (P -| left_origin) --
      node[above=-1pt,sloped,rotate=180,name=incy]
      {\scriptsize $\Delta y < 0$} (P' -| left_origin);
      % Eje z
      \node[below left=1.8ex and -0.5em] at (O) {\scriptsize $\Delta z = 0$};
      \fill[fill=white,draw=black] (O) circle[radius=2.5pt]
      node[below left] {$z$}; \fill[fill=black] (O) circle[radius=.7pt];
      \begin{scope}[on background layer]
        \node [background, fit= (incx) (incy) (letraejex) (letraejey)] {};
      \end{scope}
    \end{tikzpicture}
  \end{minipage}
  \hspace{.4em}
  \begin{minipage}{0.31\linewidth}
    \centering
    % Eje y
    \pgfmathsetmacro{\YMLONG}{0}
    \pgfmathsetmacro{\YPLONG}{3}
    % Eje z
    \pgfmathsetmacro{\ZMLONG}{0}
    \pgfmathsetmacro{\ZPLONG}{3}
    % Ángulo rotado
    \pgfmathsetmacro{\ANGROT}{20}
    % Vector P
    \pgfmathsetmacro{\PMOD}{2.5}
    \pgfmathsetmacro{\PANG}{60}
    % Vector P'
    \pgfmathsetmacro{\PPRIMAMOD}{\PMOD}
    \pgfmathsetmacro{\PPRIMAANG}{\PANG - \ANGROT}
    % 
    \centering
    \begin{tikzpicture}[%
      scale=\scl,
      every node/.style={black,font=\small},
      eje/.style={->},
      vector/.style={-{Latex}, shorten >=1.2pt, line width=.8pt},
      vectorrotado/.style={vector, draw=green!50!black},
      pcirculo/.style={fill=red, draw=black},
      pprimacirculo/.style={green!90!black, draw=black},
      background/.style={
        line width=\bgborderwidth,
        draw=\bgbordercolor,
        fill=\bgcolor,
      },      
      ]
      % Coordenadas
      \coordinate (O) at (0,0);
      \coordinate (under_origin) at (0,-3mm);
      \coordinate (left_origin) at (-3mm,0);
      \coordinate (yini) at (-\YMLONG cm,0);
      \coordinate (yfin) at (\YPLONG cm,0);
      \coordinate (zini) at (0,-\ZMLONG cm);
      \coordinate (zfin) at (0,\ZPLONG cm);
      \coordinate (P) at (\PANG:\PMOD cm);
      \coordinate (P') at  (\PPRIMAANG:\PPRIMAMOD);
      \path (O) -- coordinate (OPmidway) (P);
      \path (O) -- coordinate (OP'midway) (P');
      \path (O) -- coordinate[pos=1.2] (parrow) (P);
      \path (O) -- coordinate[pos=1.2] (p'arrow) (P');
      % Ángulo \varepsilon
      \path (P') -- (O) -- (P) pic
      [draw=black!50!,fill=green!20,"\footnotesize $\varepsilon$",angle
      radius=6mm, angle eccentricity=1.5] {angle = P'--O--P};
      % Ejes
      \draw[eje] (yini) -- (yfin);
      \node[right, name=letraejey] at (yfin) {$y$};
      \draw[eje] (zini) -- (zfin);
      \node[above, name=letraejez] at (zfin) {$z$};
      % Punto P
      \draw[vector] (O) -- (P);
      \node[above=5pt] at (OPmidway) {$\vvv{r}$};
      \fill[pcirculo] (P) circle [radius=1.4pt];
      \node[above] at (P) {$P$};
      % Punto P'
      \draw[vectorrotado] (O) -- (P');
      \node[right=0pt] at (OP'midway) {$\vvv{r}'$};
      \fill[pprimacirculo] (P') circle [radius=1.4pt];
      \node[right] at (P') {$P'$};
      % Sentido de giro del vector
      \draw [-{Latex},green!40!black,shorten <= 3pt]
      (parrow) to[bend left=30] (p'arrow);
      % Incremento y
      \draw[fill=red,draw=black] (P |- O) circle[radius=1.5pt];
      \draw[fill=green!80!black,draw=black] (P' |- O)
      circle[radius=1.5pt];
      \draw[-{Latex}] (P |- under_origin) --
      node[below,name=incy] {\scriptsize $\Delta y > 0$} (P' |- under_origin);
      % Incremento z
      \draw[fill=red,draw=black] (P -| O) circle[radius=1.5pt];
      \draw[fill=green!80!black,draw=black] (P' -| O)
      circle[radius=1.5pt];
      \draw[-{Latex}] (P -| left_origin) --
      node[above=-1pt,sloped,rotate=180,name=incz]
      {\scriptsize $\Delta z < 0$} (P' -| left_origin);
      % Eje x
      \node[below left=1.8ex and -0.5em] at (O) {\scriptsize $\Delta x = 0$};
      \fill[fill=white,draw=black] (O) circle[radius=2.5pt]
      node[below left] {$x$}; \fill[fill=black] (O) circle[radius=.7pt];
      \begin{scope}[on background layer]
        \node [background, fit= (incy) (incz) (letraejey) (letraejez)] {};
      \end{scope}
    \end{tikzpicture}
  \end{minipage}
  \hspace{.4em}
  \begin{minipage}{0.31\linewidth}
    \centering
    % Eje z
    \pgfmathsetmacro{\ZMLONG}{0}
    \pgfmathsetmacro{\ZPLONG}{3}
    % Eje x
    \pgfmathsetmacro{\XMLONG}{0}
    \pgfmathsetmacro{\XPLONG}{3}
    % Ángulo rotado
    \pgfmathsetmacro{\ANGROT}{20}
    % Vector P
    \pgfmathsetmacro{\PMOD}{2.5}
    \pgfmathsetmacro{\PANG}{60}
    % Vector P'
    \pgfmathsetmacro{\PPRIMAMOD}{\PMOD}
    \pgfmathsetmacro{\PPRIMAANG}{\PANG - \ANGROT}
    % 
    \centering
    \begin{tikzpicture}[%
      scale=\scl,
      every node/.style={black,font=\small},
      eje/.style={->},
      vector/.style={-{Latex}, shorten >=1.2pt, line width=.8pt},
      vectorrotado/.style={vector, draw=green!50!black},
      pcirculo/.style={fill=red, draw=black},
      pprimacirculo/.style={green!90!black, draw=black},
      background/.style={
        line width=\bgborderwidth,
        draw=\bgbordercolor,
        fill=\bgcolor,
      },      
      ]
      % Coordenadas
      \coordinate (O) at (0,0);
      \coordinate (under_origin) at (0,-3mm);
      \coordinate (left_origin) at (-3mm,0);
      \coordinate (zini) at (-\ZMLONG cm,0);
      \coordinate (zfin) at (\ZPLONG cm,0);
      \coordinate (xini) at (0,-\XMLONG cm);
      \coordinate (xfin) at (0,\XPLONG cm);
      \coordinate (P) at (\PANG:\PMOD cm);
      \coordinate (P') at  (\PPRIMAANG:\PPRIMAMOD);
      \path (O) -- coordinate (OPmidway) (P);
      \path (O) -- coordinate (OP'midway) (P');
      \path (O) -- coordinate[pos=1.2] (parrow) (P);
      \path (O) -- coordinate[pos=1.2] (p'arrow) (P');
      % Ángulo \varepsilon
      \path (P') -- (O) -- (P) pic
      [draw=black!50!,fill=green!20,"\footnotesize $\varepsilon$",angle
      radius=6mm, angle eccentricity=1.5] {angle = P'--O--P};
      % Ejes
      \draw[eje] (zini) -- (zfin);
      \node[right, name=letraejez] at (zfin) {$z$};
      \draw[eje] (xini) -- (xfin);
      \node[above, name=letraejex] at (xfin) {$x$};
      % Punto P
      \draw[vector] (O) -- (P);
      \node[above=5pt] at (OPmidway) {$\vvv{r}$};
      \fill[pcirculo] (P) circle [radius=1.4pt];
      \node[above] at (P) {$P$};
      % Punto P'
      \draw[vectorrotado] (O) -- (P');
      \node[right=0pt] at (OP'midway) {$\vvv{r}'$};
      \fill[pprimacirculo] (P') circle [radius=1.4pt];
      \node[right] at (P') {$P'$};
      % Sentido de giro del vector
      \draw [-{Latex},green!40!black,shorten <= 3pt]
      (parrow) to[bend left=30] (p'arrow);
      % Incremento z
      \draw[fill=red,draw=black] (P |- O) circle[radius=1.5pt];
      \draw[fill=green!80!black,draw=black] (P' |- O)
      circle[radius=1.5pt];
      \draw[-{Latex}] (P |- under_origin) --
      node[below,name=incz] {\scriptsize $\Delta z > 0$} (P' |- under_origin);
      % Incremento x
      \draw[fill=red,draw=black] (P -| O) circle[radius=1.5pt];
      \draw[fill=green!80!black,draw=black] (P' -| O)
      circle[radius=1.5pt];
      \draw[-{Latex}] (P -| left_origin) --
      node[above=-1pt,sloped,rotate=180,name=incz]
      {\scriptsize $\Delta x < 0$} (P' -| left_origin);
      % Eje y
      \node[below left=1.8ex and -0.5em] at (O) {\scriptsize $\Delta y = 0$};
      \fill[fill=white,draw=black] (O) circle[radius=2.5pt]
      node[below left] {$y$}; \fill[fill=black] (O) circle[radius=.7pt];
      \begin{scope}[on background layer]
        \node [background, fit= (incz) (incx) (letraejez) (letraejex)] {};
      \end{scope}    
    \end{tikzpicture}
  \end{minipage}
  \caption{Rotación infinitesimal de un ángulo $\varepsilon$,
    alrededor de los ejes $z$, $x$ e $y$, respectivamente.
    Tal y como se indica, el eje perpendicular en cada diagrama, ejes z, x e y,
    respectivamente, sale hacia fuera del texto.}
  \label{fig:so3-giros_zxy}
\end{figure}

\subsection{Generador para la rotación alrededor del eje
   \mathinhead{x}{x}, \mathinhead{\mmm{G}_x}{Gx}} 
 A continuación, deseamos obtener el generador del giro en el eje $x$.
 Podemos hacernos una idea de cómo construirlo mediante una representación gráfica como la anterior, pero adaptada al giro alrededor del eje $x$.

 Fijémonos en el centro de la figura \ref{fig:so3-giros_zxy} y construyamos las transformaciones que se obtienen.
 La coordenada $x$ no cambia, porque el giro en este eje no la modifica; esto se refleja en la ecuación (\ref{eq:so3-giro_x_incx}).
 La coordenada $y$ aumenta ligeramente, de ahí la suma en la expresión~(\ref{eq:so3-giro_x_incy}).
 Por último, la coordenada $z$ disminuye ligeramente, y la ecuación (\ref{eq:so3-giro_x_incz}) representa
esta transformación.
\begin{subequations}\label{eq:so3-giro_x_incxyz}
\begin{align}
  \label{eq:so3-giro_x_incx}
  x' &= x \\
  \label{eq:so3-giro_x_incy}
  y' &= y + \varepsilon z\\
  \label{eq:so3-giro_x_incz}
  z' &= z - \varepsilon y
\end{align}
\end{subequations}

{\small
  \begin{align*}
    \vvv{x'}
    &=
      \begin{pmatrix} x' \\ y' \\ z'\end{pmatrix}
    =
    \begin{pmatrix}
      x \\ y + \varepsilon z \\ z - \varepsilon y
    \end{pmatrix}
    = \begin{pmatrix}
      x \\ y \\ z
    \end{pmatrix}
    + \varepsilon
    \begin{pmatrix}
      0 \\ z \\ -y
    \end{pmatrix}\\
    &= \left[
      \begin{pmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & 1
      \end{pmatrix}
    + \varepsilon
    \begin{pmatrix}
      0 & 0 & 0 \\
      0 & 0 & 1 \\
      0 & -1 & 0
    \end{pmatrix}
    \right]
    \begin{pmatrix}
      x \\ y \\ z
    \end{pmatrix}
    =
    [\mmm{I} + \varepsilon\kern1pt\mmm{G}_x] \vvv{x}
    \approx
    \mmm{R}_x(\varepsilon)\kern1pt\vvv{x}
  \end{align*}
}

El generador para la rotación pasiva alrededor del eje $x$ resulta
\begin{equation}
  \label{eq:so3-generador_x}
  \mmm{G}_x = 
  \begin{pmatrix} 0 & 0 & 0
    \\ 0 & 0 & 1\\ 0 & -1 & 0
  \end{pmatrix}
\end{equation}

\subsection{Generador para la rotación alrededor del eje
   \mathinhead{y}{y}, \mathinhead{\mmm{G}_y}{Gy}}
Razonando de forma similar podemos obtener el generador para el giro alrededor del eje $y$, omitimos el razonamiento (ver parte derecha de la figura \ref{fig:so3-giros_zxy})
\begin{subequations}\label{eq:so3-giro_y_incxyz}
\begin{align}
  \label{eq:so3-giro_y_incx}
  x' &= x - \varepsilon z\\
  \label{giro_y_incy}
  y' &= y\\
  \label{eq:so3-giro_y_incz}
  z' &= z + \varepsilon x
\end{align}
\end{subequations}

{\small
  \begin{align*}
    \vvv{x'}
    &=
      \begin{pmatrix}
        x' \\ y' \\ z'
      \end{pmatrix}
    =
    \begin{pmatrix}
      x - \varepsilon z \\ y \\ z + \varepsilon x
    \end{pmatrix}
    = \begin{pmatrix}
      x \\ y \\ z
    \end{pmatrix}
    + \varepsilon
    \begin{pmatrix}
      -z \\ 0 \\ x
    \end{pmatrix}\\
    &= \left[
    \begin{pmatrix}
      1 & 0 & 0\\
      0 & 1 & 0\\
      0 & 0 & 1
      \end{pmatrix}
    + \varepsilon
    \begin{pmatrix}
      0 & 0 & -1 \\
      0 & 0 & 0 \\
      1 & 0 & 0
    \end{pmatrix}
    \right]
    \begin{pmatrix}
      x \\ y \\ z
    \end{pmatrix}
    =
    [\mmm{I} + \varepsilon\kern1pt\mmm{G}_y] \vvv{x}
    \approx
    \mmm{R}_y(\varepsilon)\kern1pt\vvv{x}
  \end{align*}
}

El generador para la rotación pasiva alrededor del eje $y$ resulta
\begin{equation}
  \label{eq:so3-generador_y}
  \mmm{G}_y = 
  \begin{pmatrix} 0 & 0 & -1
    \\ 0 & 0 & 0\\ 1 & 0 & 0
  \end{pmatrix}
\end{equation}

\subsection{Rotación genérica en tres dimensiones}
Hemos obtenido las tres matrices generadoras del grupo SO(3) que nos permiten obtener rotaciones alrededor de cada uno de los ejex $x$, $y$ y $z$.
\begin{equation}
  \label{eq:so3-gx_gy_gz}
  \mmm{G}_x = 
  \begin{pmatrix}
    0 & 0 & 0\\
    0 & 0 & 1\\
    0 & -1 & 0
  \end{pmatrix}
  \hspace*{1em}
  \mmm{G}_y = 
  \begin{pmatrix}
    0 & 0 & -1\\
    0 & 0 & 0\\
    1 & 0 & 0
  \end{pmatrix}
  \hspace*{1em}
  \mmm{G}_z = 
  \begin{pmatrix}
    0 & 1 & 0\\
    -1 & 0 & 0\\
    0 & 0 & 0
  \end{pmatrix}
\end{equation}

Con este generador la matriz de rotación genérica tiene la forma
\[
  \mmm{R}(\alpha) = e^{\alpha\mmm{G}}
\]
donde $\alpha$ es el ángulo girado alrededor de un eje y $\mmm{G}$ es una matriz antisimétrica.
Si sustituimos estas matrices generadoras en $\mmm{G}$, tendríamos las matrices de rotación para cada uno de los ejes, $x$, $y$ y $z$.

¿Cómo se representaría una matriz de rotación en tres dimensiones alrededor de cualquier eje, aunque no coincidiera con ningún eje de coordenadas?

Incluso antes de conocer la respuesta tenemos la seguridad de que la matriz $\mmm{G}$ seguirá siendo antisimétrica.
Pero cualquier matriz antisimétrica $3\times 3$, se construye como una combinación lineal de las $G_x$, $G_y$ y $G_z$; esto es, las matrices generadoras~(\ref{eq:so3-gx_gy_gz}) forman una base, y cualquier otra matriz que genere una rotación dentro del grupo SO(3) debe ser una combinación lineal de las anteriores.
\begin{equation}
  \label{eq:so3-combinacion_lineal}
  \mmm{G} = n_x\mmm{G}_x + n_y\mmm{G}_y + n_z\mmm{G}_z
\end{equation}
más adelante descubriremos el significado de los coeficientes, $n_x$, $n_y$ y $n_z$ de la combinación lineal.

Así, la rotación genérica queda
\begin{equation}
  \label{eq:so3-rotacion_general_3d}
  \mmm{R}_n(\alpha) = e^{\alpha\,(n_x\mmm{G}_x + n_y\mmm{G}_y + n_z\mmm{G}_z)}
\end{equation}

\subsubsection{Rotación infinitesimal}
Una de las ventajas de los grupos de Lie se basa en que como son continuos, podemos analizar su comportamiento utilizando cualquier rotación y la más sencilla es la infinitesimal, representada por el ángulo $\varepsilon$
\begin{equation}
  \label{eq:so3-rotacion_infinitesimal_n}
  \mmm{R}_n(\varepsilon)
  = \exp\left\{\varepsilon (n_x\mmm{G}_x + n_y\mmm{G}_y + n_z\mmm{G}_z)\right\}
  \approx \mmm{I} + \varepsilon (n_x\mmm{G}_x + n_y\mmm{G}_y + n_z\mmm{G}_z)
\end{equation}

Seguimos desarrollando la matriz de rotación general, alrededor de un eje genérico
\begin{align*}
  \mmm{R}_n(\varepsilon)
  &\approx \mmm{I} + \varepsilon
    \left[
    n_x\begin{pmatrix}0 & 0 & 0\\ 0 & 0 & 1\\ 0 & -1 & 0\end{pmatrix}
    + n_y\begin{pmatrix}0 & 0 & -1\\ 0 & 0 & 0\\ 1 & 0 & 0\end{pmatrix}
    + n_z\begin{pmatrix}0 & 1 & 0\\ -1 & 0 & 0\\ 0 & 0 & 0\end{pmatrix}
    \right]\\
  &= \mmm{I} + \varepsilon
    \left[
    \begin{pmatrix}0 & 0 & 0\\ 0 & 0 & n_x\\ 0 & -n_x & 0\end{pmatrix}
    + \begin{pmatrix}0 & 0 & -n_y\\ 0 & 0 & 0\\ n_y & 0 & 0\end{pmatrix}
    + \begin{pmatrix}0 & n_z & 0\\ -n_z & 0 & 0\\ 0 & 0 & 0\end{pmatrix}
   \right]\\
   &= \mmm{I} + \varepsilon
     \begin{pmatrix} 0 & n_z & -n_y\\ -n_z & 0 & n_x\\ n_y & -n_x & 0\end{pmatrix}
\end{align*}

Aplicamos este giro genérico infinitesimal a un punto
\begin{align*}
  \begin{pmatrix}
    x' \\ y' \\ z'
  \end{pmatrix}
  &=
    \mmm{R}_n(\varepsilon)
    \begin{pmatrix}
      x \\ y \\ z
    \end{pmatrix}
  \approx \left[
  \mmm{I} + \varepsilon
  \begin{pmatrix}
    0 & n_z & -n_y\\
    -n_z & 0 & n_x\\
    n_y & -n_x & 0
  \end{pmatrix}
  \right]
  \begin{pmatrix}
    x \\ y \\ z
  \end{pmatrix}\\
  &=
    \begin{pmatrix}
      x \\ y \\ z
    \end{pmatrix}
  + \varepsilon
  \begin{pmatrix}
    0 & n_z & -n_y\\
    -n_z & 0 & n_x\\
    n_y & -n_x & 0
  \end{pmatrix}
  \begin{pmatrix}
    x \\ y \\ z
  \end{pmatrix}
  =
  \begin{pmatrix}
    x \\ y \\ z
  \end{pmatrix}
  + \varepsilon
  \begin{pmatrix}
    n_zy-n_yz \\ -n_zx+n_xz \\ n_yx - n_xy
  \end{pmatrix}
\end{align*}

Los elementos del vector columna que multiplica a $\varepsilon$ son las componentes del producto vectorial
\[
  \vvv{x} \prodvec \vvv{n} =
  \begin{vmatrix}
    \hat\imath & \hat\jmath & \hat k\\
    x          & y          & z     \\
    n_x & n_y & n_z
  \end{vmatrix}
  = (n_zy-n_yz)\,\hat\imath + (n_xz-n_zx)\,\hat\jmath + (n_yx-n_xy)\,\hat k
\]

El resultado de operar la matriz de rotación infinitesimal con un vector cualquiera quedaría
\begin{equation}
  \label{eq:so3-expr_con_n}
  \vvv{x'}
  = \mmm{R}_n(\varepsilon)\kern1pt\vvv{x}
  = \vvv{x} + \varepsilon\vvv{x}\prodvec \vvv{n}
\end{equation}

\subsubsection{Significado físico del vector \vvv{n}}
Los coeficientes $n_x$, $n_y$ y $n_z$ de la combinación lineal (\ref{eq:so3-combinacion_lineal}) deben estar normalizados, esto es, su módulo debe ser la unidad
\[
  n_x^2 + n_y^2 + n_z^2 = 1
\]
 
Aunque no es una demostración, se puede comprobar fácilmente cuando el eje es uno de los de coordenadas.
Por ejemplo, rotemos infinitesimalmente alrededor del eje $z$ un punto $\vvv{x}$ utilizando la expresión (\ref{eq:so3-rotacion_infinitesimal_z})

\[
  \vvv{x'} = \mmm{R}_z(\varepsilon) \kern1pt\vvv{x} \approx (\mmm{I} +
  \varepsilon\mmm{G}_z)\kern1pt \vvv{x}
\]

Realizamos el mismo cálculo utilizando la expresión general~(\ref{eq:so3-rotacion_infinitesimal_n}), considerando una rotación alrededor del eje $z$; en este caso, $n_x = n_y = 0$
\[
  \mmm{R}_z(\varepsilon)\kern1pt \vvv{x} \approx (\mmm{I} +
  \varepsilon n_z \kern1pt\mmm{G}_z)\kern1pt \vvv{x}
\]
Comparando las dos últimas expresiones deducimos que $n_z$ debe valer uno.

Lo observado es compatible con que el vector formado por las componentes $n_x$, $n_y$ y $n_z$ sea unitario (módulo unidad), que se suele escribir $\xhat{n}$.
La expresión~(\ref{eq:so3-expr_con_n}) quedaría
\begin{equation}
  \label{eq:so3-giro_infinitesimal_x}
  \vvv{x'}
  = \mmm{R}(\xhat{n}, \varepsilon)\kern1pt \vvv{x}
  = \vvv{x} + \varepsilon\kern1pt\vvv{x}\prodvec \xhat{n}
\end{equation}

%Teniendo en cuenta lo anterior,
La matriz de rotación general infinitesimal en tres dimensiones~(\ref{eq:so3-rotacion_general_3d}) se puede abreviar sustituyendo, ---incorrectamente--- $n_xG_x+n_yG_y+n_zG_z$ por $\xhat{n}\cdot\mmm{G}$, como si fuera un
producto escalar\footnotemark{}.
\footnotetext{Téngase en cuenta que $\xhat{n}\cdot\mmm{G}$ no es un producto   escalar, aunque lo parezca. Los factores del producto escalar o producto   interno tienen que ser \emph{elementos del mismo espacio vectorial}, pero $\xhat{n}$ y $\mmm{G}$ no lo son, porque $\xhat{n}$ es un vector del espacio   ordinario $\symbb{R}^3$ y $\mmm{G}$ es un vector del espacio de   matrices cuadradas generadoras de las rotaciones en $\symbb{R}^3$.
Obsérvese que un producto escalar produce un escalar y, en nuestro caso, $\xhat{n}\cdot\mmm{G}$ resulta ser una matriz.}
\begin{equation}\label{eq:so3-ali_rot_infinitesimal_SO3}
  \mmm{R}(\xhat{n},\varepsilon)
  =
  \mmm{I} + \mmm{A}(\xhat{n},\varepsilon)
  =
  \mmm{I}
  +
  \varepsilon\xhat{n}\cdot\mmm{G}
  = \mmm{I} + \varepsilon
        \begin{pmatrix}
          0 & n_z & -n_y\\ -n_z & 0 & n_x\\ n_y & -n_x & 0
        \end{pmatrix}
\end{equation}

La matriz general de una transformacion finita se podrá escribir como
\begin{equation}\label{eq:so3-ali_rot_SO3}
  \mmm{R}(\xhat{n}, \alpha)
  = e^{\alpha (n_x\mmm{G}_x + n_y\mmm{G}_y +
    n_z\mmm{G}_z)}
  = \exp(\alpha\, \xhat{n} \cdot \mmm{G})
\end{equation}
siendo $\xhat{n}$ el versor que indica el eje de rotación, $\alpha$ el ángulo que gira el sistema de coordenadas alrededor del eje de rotación (rotación pasiva) y $\mmm{G}$ el vector formado por los generadores de la rotación en tres dimensiones.

Si $\alpha$ representara el giro de los vectores alrededor del eje de rotación, entonces la matriz de rotación sería la inversa
\begin{equation}\label{eq:so3-ali_rotobj_SO3}
  \mmm{R}(\xhat{n}, \alpha)
  = e^{-\alpha (n_x\mmm{G}_x + n_y\mmm{G}_y +
    n_z\mmm{G}_z)}
  = \exp(-\alpha\, \xhat{n} \cdot \mmm{G})
\end{equation}

\subsubsection{Rotación general de un ángulo finito por medios
  geométricos}
En (\ref{eq:so3-giro_infinitesimal_x}) obtuvimos las nuevas coordenadas de un vector $\vvv{x}$, después de una rotación pasiva infinitesimal.
Ahora estamos interesados en obtener una expresión para una rotación pasiva de un ángulo discreto $\alpha$ cualquiera, $0 \leq \alpha < 2\pi$.
Se podría conseguir desarrollando la exponencial~(\ref{eq:so3-rotacion_general_3d}),
pero sería muy laborioso; en su lugar seguiremos un razonaminento geométrico más breve.

En la figura \ref{fig:so3-giro_pasivo} se representa un giro finito positivo (en sentido
antihorario) alrededor de un eje de giro genérico.
En ella se observa un cambio aparente en las coordenadas $\vvv{x}$ de un punto a otras
$\vvv{x'}$, como si el punto hubiera girado en sentido horario el ángulo $\alpha$.
Es importante recalcar que $\vvv{x}$ y $\vvv{x'}$ son el mismo vector, y solo ha
cambiado aparentemente de posición\footnotemark{} debido a que el sistema de referencia
ha girado en sentido contrario a las agujas del reloj.
\footnotetext{En la figura el vector $\vvv{x}$ ha girado \emph{aparentemente} en sentido negativo (horario).}
Además, se aprecia que el extremo de $\vvv{x}$ describe un arco de circunferencia de radio $R$.
Obsérvese que el eje de giro definido por el vector unitario $\xhat{n}$, pasa por el centro de la circunferencia.

\pagebreak
Con ayuda de la figura \ref{fig:so3-giro_pasivo_vectores_referencia} obtendremos unas igualdades que se necesitarán posteriormente:
\begin{itemize}
\item Vemos que $\vvv{x}$ se puede descomponer en una suma de dos vectores;
  el primero, $\vvv{x}_{\scriptstyle\parallel}$ es paralelo al  eje de rotación
  y el segundo, $\vvv{x}_{\scriptstyle\perp}$ es perpendicular al anterior y se encuentra
  en el plano del arco descrito por el giro del extremo de $\vvv{x}$
  \[
    \vvv{x} = \vvv{x}_{\scriptstyle\,\parallel}
    + \vvv{x}_{\scriptstyle\perp}
  \]
 
  Despejamos $\vvv{x}_{\scriptstyle\perp}$ y ya tenemos la primera expresión
  \begin{equation}
    \label{eq:so3-x_perpendicular}
    \vvv{x}_{\scriptstyle\perp} = \vvv{x} - \vvv{x}_{\scriptstyle\,\parallel}
  \end{equation}

\item Además, se aprecia que la proyección de $\vvv{x}$ sobre el eje
  de giro es el módulo del vector $\vvv{x}_{\scriptstyle\,\parallel}$
  (altura del cono), que se calcula mediante el producto escalar de
  $\vvv{x}$ por el versor $\xhat{n}$, que representa al eje de giro
  \[
    |\vvv{x}_{\scriptstyle\,\parallel}| = \vvv{x}\cdot \xhat{n} 
  \]
   
  Por tanto
  \begin{equation}
    \label{eq:so3-x_paralela}
    \vvv{x}_{\scriptstyle\,\parallel}
    = |\vvv{x}_{\scriptstyle\,\parallel}|\,\xhat{n}
    = (\vvv{x}\cdot \xhat{n})\,\xhat{n}
  \end{equation}

\item El vector unitario asociado a $\vvv{x}_{\scriptstyle\,\perp}$ es
  \begin{equation}
    \label{eq:so3-u_perp}
    \xhat{u}_{\scriptstyle\,\perp}
    = \frac{\vvv{x}_{\scriptstyle\,\perp}}{|\vvv{x}_{\scriptstyle\,\perp}|}
    = \frac{\vvv{x}_{\scriptstyle\,\perp}}{R}
  \end{equation}
  
\item Según la figura utilizaremos el producto vectorial para definir un vector unitario
  $\xhat{u}_{\scriptstyle\,\prodvec}$, perpendicular a $\vvv{x}_{\scriptstyle\,\perp}$, situado
  en el plano de la circunferencia.
  Además, representaremos por $\beta$ el ángulo que forman $\vvv{x}$ y
  $\xhat{n}$
  \begin{equation}
    \label{eq:so3-u_prodvect}
    \hat{\vvv{u}}_{\scriptstyle\prodvec}
    =
    \frac{\vvv{x}_\prodvec}{|\vvv{x}_\prodvec|}
    =
    \frac{\vvv{x}\prodvec \xhat{n}}{|\vvv{x}\prodvec \xhat{n}|}
    =
    \frac{\vvv{x}\prodvec \xhat{n}}{|\vvv{x}|\,\sin\beta}
    =
    \frac{\vvv{x}\prodvec \xhat{n}}{R} 
  \end{equation}

\end{itemize}
  
  % #########################################################
  % PRIMERA PAREJA DE FIGURAS -CONOS-
  % #########################################################

  \begin{figure}[ht]
    \centering
    \begin{minipage}{0.46\linewidth}
      \begin{tikzpicture}[scale=1.0, baseline]
        %%% Definiciones
        \def\alturaCono{4}
        \def\alturaEjeGiro{5.5}
        \def\anchoElipse{1.8}
        \def\altoElipse{0.6}
        \def\versorn{1.6}
        \def\margenIzdo{1}
        \def\margenDcho{1}
       
        %%% Coordenadas
        \coordinate (origen) at (0,0);
        \coordinate (centro) at (60:\alturaCono cm);
        \coordinate (versorn) at (60:\versorn cm);
        \coordinate (extremoejegiro) at (60:\alturaEjeGiro cm);

        %%% Paths y otras coordenadas
        \begin{scope}[rotate around={-30:(centro)}]
          % Path Elipse
          \path[name path=ellipse] (centro) ellipse (\anchoElipse cm
          and \altoElipse cm);
          % Path altura cono
          \path[name path=alturacono] (origen) -- (centro);
          % Path Línea x
          \path[rotate=-0,name path=linex] (centro) --
          +(right:\anchoElipse cm);
          % Path línea -x
          \path[rotate=0,name path=line-x] (centro) --
          +(left:\anchoElipse cm);
          % Path Línea producto vectorial
          \path[rotate=-125,name path=lineprod] (centro) --
          +(right:\anchoElipse cm);
          % Path Línea x prima
          \path[rotate=-30,name path=linexp] (centro) --
          +(right:\anchoElipse cm);

          % Intersecciones
          \path[name intersections={of=ellipse and alturacono}]
          (intersection-1) coordinate (alturaseg); \path[name
          intersections={of=ellipse and linex}] (intersection-1)
          coordinate (endx); \path[name intersections={of=ellipse and
            line-x}] (intersection-1) coordinate (end-x); \path[name
          intersections={of=ellipse and lineprod}] (intersection-1)
          coordinate (endprod); \path[name intersections={of=ellipse
            and linexp}] (intersection-1) coordinate (endxp);
        \end{scope}

       %%%%% ÁREA DIBUJO
       
       %%% Eje de giro inferior
        \draw[black] (origen) -- (alturaseg);

        %%% Situad antes de esta parte los elementos que queramos que
        %%% se aprecian bajo el cono translúcido.
       
        %%% Cono
        \shade[draw=black!25, left color=black!10, middle
        color=black!20,right color=black!40, opacity=0.85,line
        width=0.1pt,shading angle=60] (end-x) -- (origen) -- (endx) --
        cycle;
       
        %%% Elipse
        \fill[draw=black!25,fill=yellow!20,rotate=-30,line
        width=0.1pt] (centro) ellipse (\anchoElipse cm and \altoElipse
        cm);

        %%% Ángulo girado
        \path (endx) -- (centro) -- (endxp)
        pic[draw=black!80,{Latex[length=4.5pt,width=3pt]}-,shorten
        <=-1pt, fill=orange!50,"$\scriptstyle\alpha$",angle
        radius=6mm,angle eccentricity=1.3,scale=1,bend left=70]
        {angle=endxp--centro--endx};
        % segmentos de ángulo
        \draw[black!35,line width=0.1pt] (endx) --
        node[pos=0.35,above,black!90] {\small $R$} (centro) --
        (endxp);

        %%% Vector x original
        \draw[green!50!black,-{Latex},line width=1.2pt] (origen) --
        (endx);
        % Text x
        \path (origen) -- node[pos=0.5,right=4pt,green!50!black]
        {\small $\vvv{x}$} (endx);

        %%% Vector x prima girado
        \draw[red!80!black,-{Latex},line width=1.2pt] (origen) --
        (endxp);
        % Text x prima
        \path (origen) -- node[pos=0.6,above=2pt,red!80!black] {\small
          $\vvv{x'}$} (endxp);

        %%% Eje de giro intermedio
        \draw[blue!60] (alturaseg) -- (centro);
        %%% Eje de giro superior
        \draw[black,-{Latex}] (centro) -- (extremoejegiro);
        % Texto
        \draw (extremoejegiro) node[right,black]{\small Eje de giro};

        %%% Centro de giro
        \fill[black] (centro) circle [radius=1pt];

        %%% Versor n del eje de giro
        \draw[black!60,-{Latex[width'=0pt 0.6]},line width=0.9pt]
        (origen) -- (versorn);
        % Texto
        \node[black!60,above left=-2pt and -1pt of versorn] {\small
          $\xhat{n}$};

        %%% El objetivo de este nodo es el de aumentar el espacio por
        %%% la izquierda
        \node at (-\margenIzdo,0) {}; \node at (\margenDcho,0) {};
       
      \end{tikzpicture}
      \caption{Efecto de rotación pasiva un ángulo $\alpha$ sobre un vector $\vvv{x}$ alrededor de un eje de giro genérico.}
      \label{fig:so3-giro_pasivo}
    \end{minipage}
   \hspace{2em}
   \begin{minipage}{0.4\linewidth}
     \begin{tikzpicture}[scale=1.0, baseline]
       %%% Definiciones
       \def\alturaCono{4}
       \def\alturaEjeGiro{5.5}
       \def\anchoElipse{1.8}
       \def\altoElipse{0.6}
       \def\versorn{1.6}
       \def\margenIzdo{1}
       \def\margenDcho{1}
       
       %%% Coordenadas
       \coordinate (origen) at (0,0);
       \coordinate (centro) at (60:\alturaCono cm);
       \coordinate (versorn) at (60:\versorn cm);
       \coordinate (extremoejegiro) at (60:\alturaEjeGiro cm);
       %\coordinate (margenizdo) at (-1,0);
       %\coordinate (fantasma

       %%% Paths y otras coordenadas
       \begin{scope}[rotate around={-30:(centro)}]
         % Path Elipse
         \path[name path=ellipse]
         (centro) ellipse (\anchoElipse cm and \altoElipse cm);
         % Path altura cono
         \path[name path=alturacono]
         (origen) -- (centro);
         % Path Línea x
         \path[rotate=-0,name path=linex]
         (centro) -- +(right:\anchoElipse cm);
         % Path línea -x
         \path[rotate=0,name path=line-x]
         (centro) -- +(left:\anchoElipse cm);
         % Path Línea producto vectorial
         \path[rotate=-125,name path=lineprod]
         (centro) -- +(right:\anchoElipse cm);
         % Path Línea x prima
         \path[rotate=-30,name path=linexp]
         (centro) -- +(right:\anchoElipse cm);

         % Intersecciones
         \path[name intersections={of=ellipse and alturacono}]
         (intersection-1) coordinate (alturaseg);
         \path[name intersections={of=ellipse and linex}]
         (intersection-1) coordinate (endx);
         \path[name intersections={of=ellipse and line-x}]
         (intersection-1) coordinate (end-x);
         \path[name intersections={of=ellipse and lineprod}]
         (intersection-1) coordinate (endprod);
         \path[name intersections={of=ellipse and linexp}]
         (intersection-1) coordinate (endxp);
       \end{scope}

       %%%%% ÁREA DIBUJO
       %%% Eje de giro inferior
       % \draw[black] (origen) -- (alturaseg);
       
       %%% Componente paralelo de x ||
       \draw[green!50!black,line width=0.9pt] (origen) -- (alturaseg);

       %%% Situad antes de esta parte los elementos que queramos que se aprecian
       %%% bajo el cono translúcido.
       
       %%% Cono
       \shade[draw=black!25,
       left color=black!10, middle color=black!20,right color=black!40,
       opacity=0.85,line width=0.1pt,shading angle=60]
       (end-x) -- (origen) -- (endx) -- cycle;
       
       %%% Elipse
       \fill[draw=black!25,fill=yellow!20,rotate=-30,line width=0.1pt]
       (centro) ellipse (\anchoElipse cm and \altoElipse cm);

       %%% Ángulo girado
       %\path (endx) -- (centro) -- (endxp)
       %pic[draw=black!80,{Latex[length=4.5pt,width=3pt]}-,shorten <=-1pt,
       %fill=orange!50,"$\scriptstyle\alpha$",angle
       %radius=6mm,angle eccentricity=1.3,scale=1,bend left=70]
       %{angle=endxp--centro--endx};
       % segmentos de ángulo
       %\draw[black!35,line width=0.1pt] (endx) -- (centro) -- (endxp);

       %%% Ángulo beta
       \path (endx) -- (origen) -- (centro)
       pic[draw=black!50,
       fill=black!30,"$\scriptstyle\beta$",angle radius=6mm,
       angle eccentricity=1.4,scale=1,bend left=120]
       {angle=endx--origen--centro};

       %%% Vector x original
       \draw[green!50!black,-{Latex},line width=1.2pt] (origen) -- (endx);
       % Text x
       \path (origen) -- node[pos=0.5,right=4pt,green!50!black]
       {\small $\vvv{x}$} (endx);

       %%% Vector x prima girado
       %\draw[red!80!black,-{Latex},line width=0.9pt] (origen) -- (endxp);
       % Text x prima
       %\path (origen) -- node[pos=0.6,above=2pt,red!80!black]
       %{\small $\vvv{x'}$} (endxp);

       %%% Eje de giro intermedio
       %\draw[black!50] (alturaseg) -- (centro);
       %%% Eje de giro superior
       %\draw[black,-{Latex}] (centro) -- (extremoejegiro);
       % Texto
       % \draw (extremoejegiro) node[right]{\small Eje de giro};

       %%% Componente paralelo superior de x ||
       \draw[green!40!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
       (alturaseg) -- (centro);
       % Texto
       \path (origen) -- node[green!50!black,pos=0.75,left]
       {\small $\vvv{x}_{\scriptstyle\parallel}$} (alturaseg);

       %%% Componente perpendicular de x |-
       \draw[green!50!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
       (centro) -- (endx);
       % Texto
       \path (centro) -- node[green!50!black,pos=0.6,above]
       {\small $\vvv{x}_{\scriptstyle\perp}$} (endx);
      
       %%% Componente perpendicular de x' |-
       %\draw[red!80!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
       %(centro) -- (endxp);

       %%% Componente en el plano de la elipse perpendicular
       %%% a x |-
      \draw[green!50!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
      (centro) -- (endprod);
      % Texto |- |-
      \path (centro) -- node[green!50!black,pos=-0.1,left=8pt]
      {\small$\vvv{x}_{\scriptstyle\prodvec}$} (endprod);
             
      %%% Centro de giro
      \fill[black] (centro) circle [radius=1pt];
   
      %%% Versor n del eje de giro
      \draw[black!60,-{Latex[width'=0pt 0.6]},line width=0.9pt]
      (origen) -- (versorn);
      % Texto
      \node[black!60,above left=-2pt and -1pt of versorn] {\small $\xhat{n}$};

      %%% El objetivo de este nodo es el de aumentar el espacio por la
      %%% izquierda
      \node at (-\margenIzdo,0) {};
      \node at (\margenDcho,0) {};

    \end{tikzpicture}
    \caption{Vectores de referencia para obtener el resultado de un giro pasivo de un vector $\vvv{x}$ un ángulo $\alpha$.}
    \label{fig:so3-giro_pasivo_vectores_referencia}
  \end{minipage}
\end{figure}
 
% #########################################################
% SEGUNDA PAREJA DE FIGURAS -CONOS-
% #########################################################

\begin{figure}[ht]
  \centering
  \begin{minipage}{0.4\linewidth}
    \begin{tikzpicture}[scale=1.0]
      %%% Definiciones
       \def\alturaCono{4}
       \def\alturaEjeGiro{5.5}
       \def\anchoElipse{1.8}
       \def\altoElipse{0.6}
       \def\versorn{1.6}
       \def\margenIzdo{1}
       \def\margenDcho{1}
       
       %%% Coordenadas
       \coordinate (origen) at (0,0);
       \coordinate (centro) at (60:\alturaCono cm);
       \coordinate (versorn) at (60:\versorn cm);
       \coordinate (extremoejegiro) at (60:\alturaEjeGiro cm);
       %\coordinate (margenizdo) at (-1,0);
       %\coordinate (fantasma

       %%% Paths y otras coordenadas
       \begin{scope}[rotate around={-30:(centro)}]
         % Path Elipse
         \path[name path=ellipse]
         (centro) ellipse (\anchoElipse cm and \altoElipse cm);
         % Path altura cono
         \path[name path=alturacono]
         (origen) -- (centro);
         % Path Línea x
         \path[rotate=-0,name path=linex]
         (centro) -- +(right:\anchoElipse cm);
         % Path línea -x
         \path[rotate=0,name path=line-x]
         (centro) -- +(left:\anchoElipse cm);
         % Path Línea producto vectorial
         \path[rotate=-125,name path=lineprod]
         (centro) -- +(right:\anchoElipse cm);
         % Path Línea x prima
         \path[rotate=-30,name path=linexp]
         (centro) -- +(right:\anchoElipse cm);

         % Intersecciones
         \path[name intersections={of=ellipse and alturacono}]
         (intersection-1) coordinate (alturaseg);
         \path[name intersections={of=ellipse and linex}]
         (intersection-1) coordinate (endx);
         \path[name intersections={of=ellipse and line-x}]
         (intersection-1) coordinate (end-x);
         \path[name intersections={of=ellipse and lineprod}]
         (intersection-1) coordinate (endprod);
         \path[name intersections={of=ellipse and linexp}]
         (intersection-1) coordinate (endxp);
       \end{scope}

       %%%%% ÁREA DIBUJO
       
       %%% Eje de giro inferior
       % \draw[black] (origen) -- (alturaseg);
       
       %%% Componente paralelo de x ||
       \draw[green!50!black,line width=0.9pt] (origen) -- (alturaseg);

       
       %%% Situad antes de esta parte los elementos que queramos que se aprecian
       %%% bajo el cono translúcido.
       
       %%% Cono
       \shade[draw=black!25,
       left color=black!10, middle color=black!20,right color=black!40,
       opacity=0.85,line width=0.1pt,shading angle=60]
       (end-x) -- (origen) -- (endx) -- cycle;
       
       %%% Elipse
       \fill[draw=black!25,fill=yellow!20,rotate=-30,line width=0.1pt]
       (centro) ellipse (\anchoElipse cm and \altoElipse cm);

       %%% Ángulo girado
       \path (endx) -- (centro) -- (endxp)
       pic[draw=black!80,{Latex[length=4.5pt,width=3pt]}-,shorten <=-1pt,
       fill=orange!50,"$\scriptstyle\alpha$",angle
       radius=6mm,angle eccentricity=1.3,scale=1,bend left=70]
       {angle=endxp--centro--endx};
       % segmentos de ángulo
       %\draw[black!35,line width=0.1pt] (endx) -- (centro) -- (endxp);

       %%% Vector x original
       \draw[green!50!black,-{Latex},line width=1.2pt] (origen) -- (endx);
       % Text x
       \path (origen) -- node[pos=0.5,right=4pt,green!50!black]
       {\small $\vvv{x}$} (endx);

       %%% Vector x prima girado
       \draw[red!80!black,-{Latex},line width=1.2pt] (origen) -- (endxp);
       % Text x prima
       \path (origen) -- node[pos=0.6,above=2pt,red!80!black]
       {\small $\vvv{x'}$} (endxp);

       %%% Eje de giro intermedio
       %\draw[black!50] (alturaseg) -- (centro);
       %%% Eje de giro superior
       %\draw[black,-{Latex}] (centro) -- (extremoejegiro);
       % Texto
       % \draw (extremoejegiro) node[right]{\small Eje de giro};

       %%% Componente paralelo superior de x ||
       \draw[green!40!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
       (alturaseg) -- (centro);
       % Texto
       \path (origen) -- node[green!50!black,pos=0.75,left]
       {\small $\vvv{x}_{\scriptstyle\parallel}$} (alturaseg);

       %%% Componente perpendicular de x |-
       \draw[green!50!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
       (centro) -- (endx);
       % Texto
       \path (centro) -- node[green!50!black,pos=0.6,above]
       {\small $\vvv{x}_{\scriptstyle\perp}$} (endx);
      
       %%% Componente perpendicular de x' |-
       \draw[red!80!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
       (centro) -- (endxp);
       % Texto
       \path (centro) -- node[red!80!black,pos=0.1,below=4pt]
       {\small $\vvv{x}'_{\scriptstyle\perp}$} (endxp);

       %%% Componente en el plano de la elipse perpendicular
       %%% a x |-
      \draw[green!50!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
      (centro) -- (endprod);
      % Texto |- |-
      \path (centro) -- node[green!50!black,pos=-0.1,left=8pt]
      {\small$\vvv{x}_{\scriptstyle\prodvec}$} (endprod);
             
      %%% Centro de giro
      \fill[black] (centro) circle [radius=1pt];

      %%% Ángulo beta
      % \path (endx) -- (origen) -- (centro)
      % pic[draw=black!50,
      % fill=black!30,"$\scriptstyle\beta$",angle radius=6mm,
      % angle eccentricity=1.4,scale=1,bend left=120]
      % {angle=endx--origen--centro};
       
      %%% Versor n del eje de giro
      \draw[black!60,-{Latex[width'=0pt 0.6]},line width=0.9pt]
      (origen) -- (versorn);
      % Texto
      \node[black!60,above left=-2pt and -1pt of versorn] {\small $\xhat{n}$};

      %%% El objetivo de este nodo es el de aumentar el espacio por la
      %%% izquierda
      \node at (-\margenIzdo,0) {};
      \node at (\margenDcho,0) {};
    \end{tikzpicture}
    \caption{El vector transformado $\vvv{x}'$ es la suma de
      $\vvv{x}'_{\scriptstyle\perp}$ y
      $\vvv{x}'_{\scriptstyle\,\parallel} =
      \vvv{x}_{\scriptstyle\,\parallel}$.}
    \label{fig:so3-vector_x_transformado}
  \end{minipage}
  \hspace{2em}
    \begin{minipage}{0.4\linewidth}
    \begin{tikzpicture}[scale=1.0]
      %%% Definiciones
      \def\radio{2} \def\eje{2.4}

      %%% Coordenadas
      \coordinate (origen) at (0,0);
      \coordinate (endx) at (0:\radio cm);
      \coordinate (endprod) at (-90:\radio cm);
      \coordinate (endxp) at (-40:\radio cm);

      %%% ---Dibujo---
      %%% Circunferencia
      \fill[fill=yellow!20,draw=black!25] (origen) circle[radius=\radio cm];

      %%% Ángulo girado
      \path (endx) -- (origen) -- (endxp)
      pic[draw=black!80,{Latex[length=4.5pt,width=3pt]}-,shorten
      <=-1pt, fill=orange!50,"$\scriptstyle\alpha$",angle
      radius=6mm,angle eccentricity=1.3,scale=1,bend left=70]
      {angle=endxp--origen--endx};
       
      %%% Ejes
      % x perp
      \draw[green!50!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
      (origen) -- (endx) node[right] {$\vvv{x}_{\scriptstyle\perp}$};
      % x prod
      \draw[green!50!black,-{Latex[width'=0pt 0.6]},line width=0.9pt]
      (origen) -- (endprod) node[below]
      {$\vvv{x}_{\scriptstyle\prodvec}$};

      %%% Vector x' perp
      \draw[red!80!black,-{Latex[width'=0pt 0.5]},line width=1.2pt]
      (origen) -- (endxp);
      % Texto
      \node[red!80!black,below right] at (endxp)
      {\small $\vvv{x}'_{\scriptstyle\perp}$};
      % Componente horizontal
      % \draw[red!90!black,-{Latex[width'=0pt 0.5]},line width=1.2pt]
      % (origen) --
      %%% Línea proyección sobre eje horizontal
      \draw[black!20,line width=0.1pt] ($(origen)!(endxp)!(endx)$)
      coordinate (linhoriz) -- (endxp);
      %%% Línea proyección sobre eje vertical
      \draw[black!20,line width=0.1pt] ($(origen)!(endxp)!(endprod)$)
      coordinate (linvert) -- (endxp);
      %%% Componente horizontal de x prime
      \draw[red!80!black,-{Latex[width'=0pt 0.5]},shorten >=-2pt,line
      width=1.2pt] (origen) -- (linhoriz);
      % Texto
      \path (origen) -- node[red!80!black,above]
      {\small $R\cos\alpha\,\xhat{u}_{\scriptstyle\perp}$} (linhoriz);

      %%% Componente verical de x prime
      \draw[red!80!black,-{Latex[width'=0pt 0.5]},shorten >=-2pt,line
      width=1.2pt] (origen) -- (linvert);
      % Texto
      \path (origen) -- node[red!80!black,rotate=90,above]
      {\small $R\sin\alpha\,\xhat{u}_{\scriptstyle\prodvec}$} (linvert);
      %%% Centro
      \fill[fill=black,draw=black] (origen) circle[radius=1pt];
    \end{tikzpicture}
    \caption{Circunferencia de giro y descomposición de
      $\vvv{x}'_{\scriptstyle\perp}$ en función de
      $\vvv{x}_{\scriptstyle\perp}$ y
      $\vvv{x}_{\scriptstyle\,\prodvec}$.}
    \label{fig:so3-descomposicion_xprod}
  \end{minipage}
\end{figure}

Nuestro objetivo es el vector $\vvv{x'}$ (figura \ref{fig:so3-vector_x_transformado}) , que es también una suma de dos vectores, uno paralelo al versor que define al eje de giro y otro perpendicular
\begin{equation}
  \label{eq:so3-xprima_perpendicular}
  \vvv{x'} = \vvv{x'}_{\scriptstyle\,\parallel} +
  \vvv{x'}_{\scriptstyle\perp} = \vvv{x}_{\scriptstyle\,\parallel} +
  \vvv{x'}_{\scriptstyle\perp}
\end{equation}

Ayudándonos de la figura \ref{fig:so3-descomposicion_xprod}, descompondremos $\vvv{x}'_{\scriptstyle\perp}$ en función de los vectores, perpendiculares entre sí, $\vvv{x}_{\scriptstyle\perp}$ y $\vvv{x}_{\scriptstyle\prodvec} = \vvv{x}\times\xhat{n}$
\footnotetext{Obsérvese que
  $\vvv{x}_{\scriptstyle\prodvec} = \vvv{x}_{\scriptstyle\perp}\times\xhat{n}
  = \vvv{x}\times\xhat{n}$, pero nos interesa la igualdad que contiene expresamente
  a $\vvv{x}$.}
\begin{align*}
  \vvv{x'}_{\scriptstyle\perp}
  &=
    R\cos\alpha\,\xhat{u}_{\scriptstyle\perp}
    + R\sin\alpha\,\xhat{u}_{\scriptstyle\prodvec}
    =
    R\cos\alpha\,\frac{\vvv{x}_{\scriptstyle\perp}}{|\vvv{x}_{\scriptstyle\perp}|}
    + R\sin\alpha\,\frac{\vvv{x}\prodvec\xhat{n}}{|\vvv{x}\times\xhat{n}|}\\
    &=
    \cancelout{R}\cos\alpha\,\frac{\vvv{x}_{\scriptstyle\perp}}{\cancelout{R}}
      + \cancelout{R}\sin\alpha\,\frac{\vvv{x}\prodvec\xhat{n}}{\cancelout{R}}
    = \cos\alpha\,\vvv{x}_{\scriptstyle\,\perp} + \sin\alpha\,(\vvv{x}\times\xhat{n})
\end{align*}

Sustituimos el resultado anterior en \ref{eq:so3-xprima_perpendicular}
\[
  \vvv{x}'
  =
    \vvv{x}_{\scriptstyle\,\parallel}
    + \cos\alpha\,\vvv{x}_{\scriptstyle\,\perp} + \sin\alpha\, (\vvv{x}\times\xhat{n})
\]

Ahora utilizamos la ecuación~(\ref{eq:so3-x_perpendicular}) y desarrollamos la expresión
\begin{align*}
  \vvv{x}'
  &=
    \vvv{x}_{\scriptstyle\,\parallel}
    +\cos\alpha\,(\vvv{x} - \vvv{x}_{\scriptstyle\,\parallel})
    +\sin\alpha\,(\vvv{x}\prodvec\xhat{n})\\
  &=
    \vvv{x}_{\scriptstyle\,\parallel}
    +\cos\alpha\,\vvv{x}
    - \cos\alpha\,\vvv{x}_{\scriptstyle\,\parallel}
    +\sin\alpha\,(\vvv{x}\prodvec\xhat{n})\\
  &=
    (1-\cos\alpha)\,\vvv{x}_{\scriptstyle\,\parallel}
    +\cos\alpha\,\vvv{x}
    +\sin\alpha\,(\vvv{x}\prodvec\xhat{n})
\end{align*}

Por último, sustituimos la ecuación~(\ref{eq:so3-x_paralela}) y obtenemos la ecuación que nos da las nuevas coordenadas del vector $\vvv{x}$ al girar los ejes de coordenadas un ángulo $\alpha$, alrededor de un eje definido por el versor $\xhat{n}$
\begin{equation}
  \label{eq:so3-giro3dgeom}
  \vvv{x}'
  =
  (1-\cos\alpha)\,(\vvv{x}\cdot \xhat{n})\,\xhat{n}
  +\cos\alpha\,\vvv{x}
  +\sin\alpha\,(\vvv{x}\prodvec\xhat{n})
\end{equation}


\subsubsection{Expresión matricial de una rotación general alrededor
  de un eje}
Vamos a los vectores $\xhat{x}'$, $\xhat{n}$, $\vvv{x}$ y $\vvv{x}\times\xhat{n}$ en función de sus componentes cartesianas
\begin{align}
  &\vvv{x}' = x'\xhat{i} + y'\xhat{j} + z'\xhat{k}\\
  &\xhat{n} = n_x\xhat{i} + n_y\xhat{j} + n_z\xhat{k}\\
  &\vvv{x} = x\xhat{i} + y\xhat{j} + z\xhat{k}\\
  &\vvv{x}\times\xhat{n}
    = (yn_z-zn_y)\,\xhat{i} + (zn_x-xn_z)\,\xhat{j} + (xn_y-yn_z)\,\xhat{k}
\end{align}

Sustituimos los vectores anteriores en la ecuación \eqref{eq:so3-giro3dgeom}
\begin{align*}
  \vvv{x}'
  &=
    (1-\cos\alpha)\,(\vvv{x}\cdot \xhat{n})\,
    \begin{pmatrix}
      n_x\\
      n_y\\
      n_z
    \end{pmatrix}
  +\cos\alpha\,
  \begin{pmatrix}
    x\\
    y\\
    z
  \end{pmatrix}
  +\sin\alpha\,
  \begin{pmatrix}
    yn_z-zn_y\\
    zn_x-xn_z\\
    xn_y-yn_z
  \end{pmatrix}    
\end{align*}
%}

Y expresamos matricialmente el resultado de la rotación
anterior~(\ref{eq:so3-giro3dgeom})
{\small
   \begin{equation}\label{eq:so3-giro3dmatricial}
     \begin{pmatrix}
       x' \\ y' \\ z'
     \end{pmatrix}
     =
     \mmm{R}(\xhat{n}, \alpha)
     \begin{pmatrix}
       x \\ y \\ z
     \end{pmatrix}
     =
     \begin{pmatrix}
       (1-\cos\alpha)(\vvv{x}\cdot\xhat{n})\,n_x
       + \cos\alpha \,x + \sin\alpha \,n_zy - \sin\alpha \,n_yz\\
       (1-\cos\alpha)(\vvv{x}\cdot\xhat{n})\,n_y + \cos\alpha \,y
       + \sin\alpha \,n_xz - \sin\alpha \,n_zx\\
       (1-\cos\alpha)(\vvv{x}\cdot\xhat{n})\,n_z + \cos\alpha \,z +
       \sin\alpha \,n_yx - \sin\alpha \,n_xy
     \end{pmatrix}
   \end{equation}
}

A partir de \ref{eq:so3-giro3dmatricial} deducimos la matriz de rotación general, ecuación (\ref{eq:so3-matrizrotaciongeneral}).
Dejamos como ejercicio ésta, desarrollando el término $\vvv{x}\cdot\xhat{n}$ mediante las componentes cartesianas $xn_x + yn_y + zn_z$, sacando factor común los términos en $x$, en $y$ y en $z$, comparándose con los términos del producto $\mmm{R}(\xhat{n},\alpha) \vvv{x}$.
{\small
  \begin{equation}\label{eq:so3-matrizrotaciongeneral}
    \mmm{R}(\xhat{n}, \alpha)
    =
    \begin{pmatrix}
      (1-\cos\alpha)n_x^2 + \cos\alpha & (1-\cos\alpha)n_yn_x
      +n_z\sin\alpha & (1-\cos\alpha)n_zn_x-n_y\sin\alpha\\[0.3ex]
      (1-\cos\alpha)n_xn_y-n_z\sin\alpha & (1-\cos\alpha)n_y^2
      +\cos\alpha & (1-\cos\alpha)n_zn_y+n_x\sin\alpha\\[0.3ex]
      (1-\cos\alpha)n_xn_z+n_Y\sin\alpha &
      (1-\cos\alpha)n_yn_z-n_x\sin\alpha &
      (1-\cos\alpha)n_z^2+\cos\alpha
    \end{pmatrix}
  \end{equation}
}

Si conociéramos el versor de giro en coordenadas esféricas, sus coordenadas cartesianas rectangulares serían
\begin{align*}
  n_x &= \sin\theta \cos\phi\\
  n_y &= \sin\theta \sin\phi\\
  n_z &= \cos\theta
\end{align*}

\subsubsection{¿Qué es el grupo SO(3)?}
Es el conjunto de matrices $3\times 3$, ortogonales y singulares
\[
  SO(3) = \left\{\mmm{R}_{3\times 3} \,/\, \mmm{R}^\trasp \mmm{R} =
    \mmm{I}, \det\mmm{R} = 1\right\}
\]

El número $3$ viene de las tres direcciones del espacio.
Este grupo tiene tres parámetros independientes o grados de libertad (o bien tres generadores independientes, como vimos anteriormente).
Por un lado, tenemos los cuatro parámetros, $\alpha$, $n_x$, $n_y$ y $n_z$, pero estos últimos tienen que estar normalizados, por lo que hay una ecuación que los relaciona, $n_x^2+n_y^2+n_z^2=1$; así quedan, $4-1=3$, tres parámetros independientes.
Los tres parámetros independientes podrían ser también, el ángulo girado, $\alpha$, y los dos ángulos del vector de giro en coordenadas esféricas, $\theta$ y $\phi$. 

El grupo SO(4) sería el grupo de rotaciones en un espacio euclídeo de cuatro dimensiones, pero tendría seis parámetros, que se pueden razonar hallando el número de generadores del grupo, tal como hicimos anteriormente para SO(3), en la sección \ref{subsec:num_gen_so3}.






%%% Local Variables:
%%% mode: latex
%%% TeX-engine: luatex
%%% TeX-master: "../gruposlie.tex"
%%% End:
